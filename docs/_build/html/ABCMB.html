<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ABCMB package &#8212; ABCMB 0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=837179f8"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ABCMB.hyrax package" href="ABCMB.hyrax.html" />
    <link rel="prev" title="ABCMB" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="abcmb-package">
<h1>ABCMB package<a class="headerlink" href="#abcmb-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ABCMB.hyrax.html">ABCMB.hyrax package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#module-ABCMB.hyrax.array_with_padding">ABCMB.hyrax.array_with_padding module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding"><code class="docutils literal notranslate"><span class="pre">array_with_padding</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding.arr"><code class="docutils literal notranslate"><span class="pre">array_with_padding.arr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding.concat"><code class="docutils literal notranslate"><span class="pre">array_with_padding.concat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding.lastnum"><code class="docutils literal notranslate"><span class="pre">array_with_padding.lastnum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding.lastval"><code class="docutils literal notranslate"><span class="pre">array_with_padding.lastval</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding.padding_size"><code class="docutils literal notranslate"><span class="pre">array_with_padding.padding_size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#module-ABCMB.hyrax.cosmology">ABCMB.hyrax.cosmology module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.cosmology.Hubble"><code class="docutils literal notranslate"><span class="pre">Hubble()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.cosmology.TCMB"><code class="docutils literal notranslate"><span class="pre">TCMB()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.cosmology.a"><code class="docutils literal notranslate"><span class="pre">a()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.cosmology.nH"><code class="docutils literal notranslate"><span class="pre">nH()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.cosmology.omega_rad0"><code class="docutils literal notranslate"><span class="pre">omega_rad0()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#module-ABCMB.hyrax.helium">ABCMB.hyrax.helium module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model"><code class="docutils literal notranslate"><span class="pre">helium_model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.concrete_axis_size"><code class="docutils literal notranslate"><span class="pre">helium_model.concrete_axis_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.concrete_axis_size_postSahaHe"><code class="docutils literal notranslate"><span class="pre">helium_model.concrete_axis_size_postSahaHe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.get_helium_history"><code class="docutils literal notranslate"><span class="pre">helium_model.get_helium_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.helium_dxHeIIdlna"><code class="docutils literal notranslate"><span class="pre">helium_model.helium_dxHeIIdlna()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.integration_spacing"><code class="docutils literal notranslate"><span class="pre">helium_model.integration_spacing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.lna_axis_4Heequil"><code class="docutils literal notranslate"><span class="pre">helium_model.lna_axis_4Heequil</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.post_saha_xHeII"><code class="docutils literal notranslate"><span class="pre">helium_model.post_saha_xHeII()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.solve_HeII_full"><code class="docutils literal notranslate"><span class="pre">helium_model.solve_HeII_full()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.xH1_Saha"><code class="docutils literal notranslate"><span class="pre">helium_model.xH1_Saha()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.xHeII_post_Saha"><code class="docutils literal notranslate"><span class="pre">helium_model.xHeII_post_Saha()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.xe_derivative_HeII"><code class="docutils literal notranslate"><span class="pre">helium_model.xe_derivative_HeII()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.helium.helium_model.xesaha_HeII_III"><code class="docutils literal notranslate"><span class="pre">helium_model.xesaha_HeII_III()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#module-ABCMB.hyrax.hydrogen">ABCMB.hyrax.hydrogen module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model"><code class="docutils literal notranslate"><span class="pre">hydrogen_model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.Lyn_esc_rate"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.Lyn_esc_rate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.concrete_axis_size"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.concrete_axis_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.dxe_dlna_twophoton"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.dxe_dlna_twophoton()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.get_current_correction_func"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.get_current_correction_func()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.get_hydrogen_history"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.get_hydrogen_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.integration_spacing"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.integration_spacing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.last_4He_lna"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.last_4He_lna</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.lna_4He"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.lna_4He</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.lna_axis_late"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.lna_axis_late</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.post_Saha_expansion"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.post_Saha_expansion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.solve_emla"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.solve_emla()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.solve_emla_twophoton"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.solve_emla_twophoton()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.steady_state_equations"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.steady_state_equations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.swift"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.swift</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.twog_redshift"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.twog_redshift</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.xe_4He"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.xe_4He</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.xe_derivative_twophoton"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.xe_derivative_twophoton()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hydrogen.hydrogen_model.xe_tm_derivative"><code class="docutils literal notranslate"><span class="pre">hydrogen_model.xe_tm_derivative()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#module-ABCMB.hyrax.hyrax">ABCMB.hyrax.hyrax module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model"><code class="docutils literal notranslate"><span class="pre">recomb_model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.Delta_z_reion"><code class="docutils literal notranslate"><span class="pre">recomb_model.Delta_z_reion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.He4equil_redshift"><code class="docutils literal notranslate"><span class="pre">recomb_model.He4equil_redshift</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.concrete_axis_size"><code class="docutils literal notranslate"><span class="pre">recomb_model.concrete_axis_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.concrete_axis_size_postSahaHe"><code class="docutils literal notranslate"><span class="pre">recomb_model.concrete_axis_size_postSahaHe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.get_history"><code class="docutils literal notranslate"><span class="pre">recomb_model.get_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.idx_4He_equil"><code class="docutils literal notranslate"><span class="pre">recomb_model.idx_4He_equil</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.idx_late"><code class="docutils literal notranslate"><span class="pre">recomb_model.idx_late</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.integration_spacing"><code class="docutils literal notranslate"><span class="pre">recomb_model.integration_spacing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.lna_axis_full"><code class="docutils literal notranslate"><span class="pre">recomb_model.lna_axis_full</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.twog_redshift"><code class="docutils literal notranslate"><span class="pre">recomb_model.twog_redshift</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model.z_reion"><code class="docutils literal notranslate"><span class="pre">recomb_model.z_reion</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#module-ABCMB.hyrax.recomb_functions">ABCMB.hyrax.recomb_functions module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.recomb_functions.Gamma_compton"><code class="docutils literal notranslate"><span class="pre">Gamma_compton()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.recomb_functions.effective_coefficients"><code class="docutils literal notranslate"><span class="pre">effective_coefficients()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.recomb_functions.xe_Saha"><code class="docutils literal notranslate"><span class="pre">xe_Saha()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ABCMB.hyrax.html#module-ABCMB.hyrax">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-ABCMB.ABCMBTools">
<span id="abcmb-abcmbtools-module"></span><h2>ABCMB.ABCMBTools module<a class="headerlink" href="#module-ABCMB.ABCMBTools" title="Link to this heading">¶</a></h2>
<p>Script for helper numerical tools</p>
<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.ABCMBTools.d00">
<span class="sig-prename descclassname"><span class="pre">ABCMB.ABCMBTools.</span></span><span class="sig-name descname"><span class="pre">d00</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ells</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/ABCMBTools.html#d00"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.ABCMBTools.d00" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.ABCMBTools.d1n">
<span class="sig-prename descclassname"><span class="pre">ABCMB.ABCMBTools.</span></span><span class="sig-name descname"><span class="pre">d1n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/ABCMBTools.html#d1n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.ABCMBTools.d1n" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.ABCMBTools.d2n">
<span class="sig-prename descclassname"><span class="pre">ABCMB.ABCMBTools.</span></span><span class="sig-name descname"><span class="pre">d2n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/ABCMBTools.html#d2n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.ABCMBTools.d2n" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.ABCMBTools.d3n">
<span class="sig-prename descclassname"><span class="pre">ABCMB.ABCMBTools.</span></span><span class="sig-name descname"><span class="pre">d3n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/ABCMBTools.html#d3n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.ABCMBTools.d3n" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.ABCMBTools.d4n">
<span class="sig-prename descclassname"><span class="pre">ABCMB.ABCMBTools.</span></span><span class="sig-name descname"><span class="pre">d4n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/ABCMBTools.html#d4n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.ABCMBTools.d4n" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.ABCMBTools.fast_interp">
<span class="sig-prename descclassname"><span class="pre">ABCMB.ABCMBTools.</span></span><span class="sig-name descname"><span class="pre">fast_interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/ABCMBTools.html#fast_interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.ABCMBTools.fast_interp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.ABCMBTools.wigner_d_matrix">
<span class="sig-prename descclassname"><span class="pre">ABCMB.ABCMBTools.</span></span><span class="sig-name descname"><span class="pre">wigner_d_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/ABCMBTools.html#wigner_d_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.ABCMBTools.wigner_d_matrix" title="Link to this definition">¶</a></dt>
<dd><p>m, n are integers. m must be positive and greater than n.
ells an array ([m, m+1, m+2, …, ellmax])</p>
</dd></dl>

</section>
<section id="module-ABCMB.AbstractSpecies">
<span id="abcmb-abstractspecies-module"></span><h2>ABCMB.AbstractSpecies module<a class="headerlink" href="#module-ABCMB.AbstractSpecies" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractFluid">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">AbstractFluid</span></span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractFluid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractFluid" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Abstract base class for fluid species in cosmological simulations.</p>
<p>Defines an interface for computing fluid thermodynamic properties.</p>
<section id="methods">
<h3>Methods:<a class="headerlink" href="#methods" title="Link to this heading">¶</a></h3>
<p>rho : Compute energy density (units: eV cm^{-3})
P : Compute pressure (units: eV cm^{-3})
cs2 : Compute sound speed squared (units: dimensionless)
w : Compute equation of state parameter (units: dimensionless)</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractFluid.P">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractFluid.P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractFluid.P" title="Link to this definition">¶</a></dt>
<dd><p>Compute pressure.</p>
<p>Calculates the pressure of the fluid species at a given
cosmological epoch using the logarithm of the scale factor.</p>
<section id="parameters">
<h4>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns:<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractFluid.cs2">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractFluid.cs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractFluid.cs2" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound speed squared.</p>
<p>Calculates the squared sound speed of the fluid species at a given
cosmological epoch using the logarithm of the scale factor.</p>
<section id="id1">
<h4>Parameters:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id2">
<h4>Returns:<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound speed squared (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractFluid.rho">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractFluid.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractFluid.rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute energy density.</p>
<p>Calculates the energy density of the fluid species at a given
cosmological epoch using the logarithm of the scale factor.</p>
<section id="id3">
<h4>Parameters:<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id4">
<h4>Returns:<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Energy density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractFluid.w">
<span class="sig-name descname"><span class="pre">w</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractFluid.w"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractFluid.w" title="Link to this definition">¶</a></dt>
<dd><p>Compute equation of state parameter.</p>
<p>Calculates the ratio of pressure to energy density, representing
the equation of state for the fluid species.</p>
<section id="id5">
<h4>Parameters:<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id6">
<h4>Returns:<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Equation of state parameter (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">AbstractPerturbedFluid</span></span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractPerturbedFluid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractFluid" title="ABCMB.AbstractSpecies.AbstractFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFluid</span></code></a></p>
<p>Abstract base class for fluid species with perturbations.</p>
<p>Defines methods for computing perturbation mode properties
used in this code.</p>
<section id="id7">
<h3>Methods:<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>y_ini : Compute initial perturbation mode conditions (units: dimensionless)
y_prime : Compute perturbation mode time derivatives (units: dimensionless)
rho_delta : Compute density perturbation (units: eV cm^{-3})
rho_plus_P_theta : Compute velocity perturbation (units: eV cm^{-3})
rho_plus_P_sigma : Compute shear perturbation (units: eV cm^{-3})</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid.delta_idx">
<span class="sig-name descname"><span class="pre">delta_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AbstractVar</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid.delta_idx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid.num_ell_modes">
<span class="sig-name descname"><span class="pre">num_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AbstractVar</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid.num_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid.rho_delta">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractPerturbedFluid.rho_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid.rho_delta" title="Link to this definition">¶</a></dt>
<dd><p>Compute density perturbation.</p>
<section id="id8">
<h4>Parameters:<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id9">
<h4>Returns:<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Density perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid.rho_plus_P_sigma">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho_plus_P_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractPerturbedFluid.rho_plus_P_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid.rho_plus_P_sigma" title="Link to this definition">¶</a></dt>
<dd><p>Compute shear perturbation.</p>
<section id="id10">
<h4>Parameters:<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id11">
<h4>Returns:<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Shear perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid.rho_plus_P_theta">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho_plus_P_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractPerturbedFluid.rho_plus_P_theta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid.rho_plus_P_theta" title="Link to this definition">¶</a></dt>
<dd><p>Compute velocity perturbation.</p>
<section id="id12">
<h4>Parameters:<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id13">
<h4>Returns:<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Velocity perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid.y_ini">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y_ini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">om</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractPerturbedFluid.y_ini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid.y_ini" title="Link to this definition">¶</a></dt>
<dd><p>Compute initial conditions for perturbation modes.</p>
<p>Calculates the initial state of perturbation modes at early cosmological times.</p>
<section id="id14">
<h4>Parameters:<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>tau_ini<span class="classifier">float</span></dt><dd><p>Initial conformal time (units: Mpc)</p>
</dd>
<dt>om<span class="classifier">float</span></dt><dd><p>Matter density parameter</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id15">
<h4>Returns:<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Initial perturbation mode values (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractPerturbedFluid.y_prime">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractPerturbedFluid.y_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid.y_prime" title="Link to this definition">¶</a></dt>
<dd><p>Compute time derivatives of perturbation modes.</p>
<p>Calculates how perturbation modes evolve with cosmological time.</p>
<section id="id16">
<h4>Parameters:<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>metric_h_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric h</p>
</dd>
<dt>metric_eta_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric eta</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Current perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id17">
<h4>Returns:<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Time derivatives of perturbation modes (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">AbstractStandardPerturbedFluid</span></span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractStandardPerturbedFluid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractPerturbedFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPerturbedFluid</span></code></a></p>
<p>Standard implementation of perturbation methods for fluid species.</p>
<p>Provides default computations for perturbation-related methods
used in this code.</p>
<section id="id18">
<h3>Methods:<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<p>rho_delta : Compute standard density perturbation (units: eV cm^{-3})
rho_plus_P_theta : Compute standard velocity perturbation (units: eV cm^{-3})
rho_plus_P_sigma : Compute standard shear perturbation (units: eV cm^{-3})</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid.rho_delta">
<span class="sig-name descname"><span class="pre">rho_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractStandardPerturbedFluid.rho_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid.rho_delta" title="Link to this definition">¶</a></dt>
<dd><p>Compute density perturbation.</p>
<section id="id19">
<h4>Parameters:<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id20">
<h4>Returns:<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Density perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid.rho_plus_P_sigma">
<span class="sig-name descname"><span class="pre">rho_plus_P_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractStandardPerturbedFluid.rho_plus_P_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid.rho_plus_P_sigma" title="Link to this definition">¶</a></dt>
<dd><p>Compute shear perturbation.</p>
<section id="id21">
<h4>Parameters:<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id22">
<h4>Returns:<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Shear perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid.rho_plus_P_theta">
<span class="sig-name descname"><span class="pre">rho_plus_P_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#AbstractStandardPerturbedFluid.rho_plus_P_theta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid.rho_plus_P_theta" title="Link to this definition">¶</a></dt>
<dd><p>Compute velocity perturbation.</p>
<section id="id23">
<h4>Parameters:<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id24">
<h4>Returns:<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Velocity perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">Baryon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">photon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractPerturbedFluid"><span class="pre">AbstractPerturbedFluid</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Baryon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractStandardPerturbedFluid</span></code></a></p>
<p>Baryon fluid species implementation.</p>
<p>Non-relativistic baryons with density and velocity perturbations.</p>
<section id="id25">
<h3>Methods:<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<p>rho : Compute baryon density (units: eV cm^{-3})
P : Compute baryon pressure (units: eV cm^{-3})
cs2 : Compute sound speed squared (units: dimensionless)
mean_mass : Compute mean baryon mass (units: eV)
y_ini : Compute initial perturbation conditions (units: dimensionless)
y_prime : Compute perturbation time derivatives (units: dimensionless)</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.P">
<span class="sig-name descname"><span class="pre">P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Baryon.P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.P" title="Link to this definition">¶</a></dt>
<dd><p>Compute baryon pressure.</p>
<section id="id26">
<h4>Parameters:<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id27">
<h4>Returns:<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Baryon pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
<section id="notes">
<h4>Notes:<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h4>
<p>Baryon pressure is neglected, standard practice for SM baryons.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.cs2">
<span class="sig-name descname"><span class="pre">cs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Baryon.cs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.cs2" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound speed squared.</p>
<section id="id28">
<h4>Parameters:<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id29">
<h4>Returns:<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound speed squared (units: dimensionless)</p>
</dd>
</dl>
</section>
<section id="id30">
<h4>Notes:<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h4>
<p>Adiabatic sound speed squared, taken from M&amp;B Eq. (68).
Although we can neglect the pressure, this term is important for perturbation growth
during recombination. During reionization this cs2 is negative. This is not physical
but it should not matter for cosmology.</p>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.delta_idx">
<span class="sig-name descname"><span class="pre">delta_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.delta_idx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.mean_mass">
<span class="sig-name descname"><span class="pre">mean_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Baryon.mean_mass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.mean_mass" title="Link to this definition">¶</a></dt>
<dd><p>Compute mean baryon mass at given redshift.</p>
<section id="id31">
<h4>Parameters:<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id32">
<h4>Returns:<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Mean baryon mass (units: eV)</p>
</dd>
</dl>
</section>
<section id="id33">
<h4>Notes:<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h4>
<p>Defined to be mu = rho_b / n_b = rho_b / (nH + nHe + ne)</p>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.num_ell_modes">
<span class="sig-name descname"><span class="pre">num_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AbstractVar</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.num_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.photon">
<span class="sig-name descname"><span class="pre">photon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractPerturbedFluid"><span class="pre">AbstractPerturbedFluid</span></a></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.photon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.rho">
<span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Baryon.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute baryon density.</p>
<section id="id34">
<h4>Parameters:<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id35">
<h4>Returns:<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Baryon density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.y_ini">
<span class="sig-name descname"><span class="pre">y_ini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">om</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Baryon.y_ini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.y_ini" title="Link to this definition">¶</a></dt>
<dd><p>Compute initial conditions for baryon perturbations.</p>
<section id="id36">
<h4>Parameters:<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>tau_ini<span class="classifier">float</span></dt><dd><p>Initial conformal time (units: Mpc)</p>
</dd>
<dt>om<span class="classifier">float</span></dt><dd><p>Matter density parameter</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id37">
<h4>Returns:<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Initial perturbation mode values (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Baryon.y_prime">
<span class="sig-name descname"><span class="pre">y_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Baryon.y_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Baryon.y_prime" title="Link to this definition">¶</a></dt>
<dd><p>Compute time derivatives of baryon perturbations.</p>
<section id="id38">
<h4>Parameters:<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>metric_h_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric h</p>
</dd>
<dt>metric_eta_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric eta</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Current perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id39">
<h4>Returns:<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Time derivatives of perturbation modes (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">ColdDarkMatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#ColdDarkMatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractStandardPerturbedFluid</span></code></a></p>
<p>Cold dark matter fluid species implementation.</p>
<p>Non-relativistic, pressureless dark matter with density
perturbations but no velocity or shear modes.</p>
<section id="id40">
<h3>Methods:<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<p>rho : Compute cold dark matter density (units: eV cm^{-3})
P : Compute cold dark matter pressure (units: eV cm^{-3})
cs2 : Compute sound speed squared (units: dimensionless)
y_ini : Compute initial perturbation conditions (units: dimensionless)
y_prime : Compute perturbation time derivatives (units: dimensionless)</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter.P">
<span class="sig-name descname"><span class="pre">P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#ColdDarkMatter.P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter.P" title="Link to this definition">¶</a></dt>
<dd><p>Compute cold dark matter pressure.</p>
<section id="id41">
<h4>Parameters:<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id42">
<h4>Returns:<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Cold dark matter pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
<section id="id43">
<h4>Notes:<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h4>
<p>Cold dark matter is pressureless, so this always returns zero.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter.cs2">
<span class="sig-name descname"><span class="pre">cs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#ColdDarkMatter.cs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter.cs2" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound speed squared.</p>
<section id="id44">
<h4>Parameters:<a class="headerlink" href="#id44" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id45">
<h4>Returns:<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound speed squared (units: dimensionless)</p>
</dd>
</dl>
</section>
<section id="id46">
<h4>Notes:<a class="headerlink" href="#id46" title="Link to this heading">¶</a></h4>
<p>For cold dark matter, sound speed is always zero due to its
non-relativistic and pressureless nature.</p>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter.delta_idx">
<span class="sig-name descname"><span class="pre">delta_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter.delta_idx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter.num_ell_modes">
<span class="sig-name descname"><span class="pre">num_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AbstractVar</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter.num_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter.rho">
<span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#ColdDarkMatter.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter.rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute cold dark matter density.</p>
<section id="id47">
<h4>Parameters:<a class="headerlink" href="#id47" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id48">
<h4>Returns:<a class="headerlink" href="#id48" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Cold dark matter density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter.y_ini">
<span class="sig-name descname"><span class="pre">y_ini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">om</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#ColdDarkMatter.y_ini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter.y_ini" title="Link to this definition">¶</a></dt>
<dd><p>Compute initial conditions for cold dark matter perturbations.</p>
<section id="id49">
<h4>Parameters:<a class="headerlink" href="#id49" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>tau_ini<span class="classifier">float</span></dt><dd><p>Initial conformal time (units: Mpc)</p>
</dd>
<dt>om<span class="classifier">float</span></dt><dd><p>Matter density parameter</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id50">
<h4>Returns:<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Initial density perturbation (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.ColdDarkMatter.y_prime">
<span class="sig-name descname"><span class="pre">y_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#ColdDarkMatter.y_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.ColdDarkMatter.y_prime" title="Link to this definition">¶</a></dt>
<dd><p>Compute time derivatives of cold dark matter perturbations.</p>
<section id="id51">
<h4>Parameters:<a class="headerlink" href="#id51" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>metric_h_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric h</p>
</dd>
<dt>metric_eta_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric eta</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Current perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id52">
<h4>Returns:<a class="headerlink" href="#id52" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Time derivative of density perturbation (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.DarkEnergy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">DarkEnergy</span></span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#DarkEnergy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.DarkEnergy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractFluid" title="ABCMB.AbstractSpecies.AbstractFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractFluid</span></code></a></p>
<p>Dark energy fluid species implementation.</p>
<p>Represents a constant energy density fluid with negative pressure.</p>
<section id="id53">
<h3>Methods:<a class="headerlink" href="#id53" title="Link to this heading">¶</a></h3>
<p>rho : Compute dark energy density (units: eV cm^{-3})
P : Compute dark energy pressure (units: eV cm^{-3})
cs2 : Compute sound speed squared (units: dimensionless)</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.DarkEnergy.P">
<span class="sig-name descname"><span class="pre">P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#DarkEnergy.P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.DarkEnergy.P" title="Link to this definition">¶</a></dt>
<dd><p>Compute dark energy pressure.</p>
<section id="id54">
<h4>Parameters:<a class="headerlink" href="#id54" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id55">
<h4>Returns:<a class="headerlink" href="#id55" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Dark energy pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.DarkEnergy.cs2">
<span class="sig-name descname"><span class="pre">cs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#DarkEnergy.cs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.DarkEnergy.cs2" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound speed squared.</p>
<section id="id56">
<h4>Parameters:<a class="headerlink" href="#id56" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id57">
<h4>Returns:<a class="headerlink" href="#id57" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound speed squared (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.DarkEnergy.rho">
<span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#DarkEnergy.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.DarkEnergy.rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute dark energy density.</p>
<section id="id58">
<h4>Parameters:<a class="headerlink" href="#id58" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id59">
<h4>Returns:<a class="headerlink" href="#id59" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Dark energy density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">MassiveNeutrinos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_q_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ells_per_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractPerturbedFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractPerturbedFluid</span></code></a></p>
<p>Massive neutrinos fluid species implementation.</p>
<p>Non-relativistic neutrinos with multiple angular momentum modes.</p>
<section id="id60">
<h3>Methods:<a class="headerlink" href="#id60" title="Link to this heading">¶</a></h3>
<p>rho : Compute massive neutrino density (units: eV cm^{-3})
P : Compute massive neutrino pressure (units: eV cm^{-3})
cs2 : Compute sound speed squared (units: dimensionless)
y_ini : Compute initial perturbation conditions (units: dimensionless)
y_prime : Compute perturbation time derivatives (units: dimensionless)
rho_delta : Compute density perturbation (units: eV cm^{-3})
rho_plus_P_theta : Compute velocity perturbation (units: eV cm^{-3})
rho_plus_P_sigma : Compute shear perturbation (units: eV cm^{-3})</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.P">
<span class="sig-name descname"><span class="pre">P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.P" title="Link to this definition">¶</a></dt>
<dd><p>Compute massive neutrino pressure.</p>
<section id="id61">
<h4>Parameters:<a class="headerlink" href="#id61" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float or ArrayLike</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id62">
<h4>Returns:<a class="headerlink" href="#id62" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float or ArrayLike</dt><dd><p>Massive neutrino pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.cs2">
<span class="sig-name descname"><span class="pre">cs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.cs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.cs2" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound speed squared.</p>
<section id="id63">
<h4>Parameters:<a class="headerlink" href="#id63" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float or ArrayLike</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id64">
<h4>Returns:<a class="headerlink" href="#id64" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float or ArrayLike</dt><dd><p>Sound speed squared (units: dimensionless)</p>
</dd>
</dl>
</section>
<section id="id65">
<h4>Notes:<a class="headerlink" href="#id65" title="Link to this heading">¶</a></h4>
<p>Uses equation of state parameter w as approximation.</p>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.delta_idx">
<span class="sig-name descname"><span class="pre">delta_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.delta_idx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.num_ell_modes">
<span class="sig-name descname"><span class="pre">num_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.num_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.num_ells_per_bin">
<span class="sig-name descname"><span class="pre">num_ells_per_bin</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.num_ells_per_bin" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.num_q_bins">
<span class="sig-name descname"><span class="pre">num_q_bins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.num_q_bins" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.q_3p">
<span class="sig-name descname"><span class="pre">q_3p</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array([0.913201,</span> <span class="pre">3.37517</span> <span class="pre">,</span> <span class="pre">7.79184</span> <span class="pre">],</span> <span class="pre">dtype=float64)</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.q_3p" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.q_5p">
<span class="sig-name descname"><span class="pre">q_5p</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array([</span> <span class="pre">0.583165,</span>&#160; <span class="pre">2.</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">,</span>&#160; <span class="pre">4.</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">,</span>&#160; <span class="pre">7.26582</span> <span class="pre">,</span> <span class="pre">13.</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">],</span> <span class="pre">dtype=float64)</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.q_5p" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.rho">
<span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute massive neutrino density.</p>
<section id="id66">
<h4>Parameters:<a class="headerlink" href="#id66" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float or ArrayLike</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id67">
<h4>Returns:<a class="headerlink" href="#id67" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float or ArrayLike</dt><dd><p>Massive neutrino density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.rho_delta">
<span class="sig-name descname"><span class="pre">rho_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.rho_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.rho_delta" title="Link to this definition">¶</a></dt>
<dd><p>Compute massive neutrino density perturbation.</p>
<section id="id68">
<h4>Parameters:<a class="headerlink" href="#id68" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id69">
<h4>Returns:<a class="headerlink" href="#id69" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Density perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.rho_plus_P_sigma">
<span class="sig-name descname"><span class="pre">rho_plus_P_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.rho_plus_P_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.rho_plus_P_sigma" title="Link to this definition">¶</a></dt>
<dd><p>Compute massive neutrino shear perturbation.</p>
<section id="id70">
<h4>Parameters:<a class="headerlink" href="#id70" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id71">
<h4>Returns:<a class="headerlink" href="#id71" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Shear perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.rho_plus_P_theta">
<span class="sig-name descname"><span class="pre">rho_plus_P_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.rho_plus_P_theta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.rho_plus_P_theta" title="Link to this definition">¶</a></dt>
<dd><p>Compute massive neutrino velocity perturbation.</p>
<section id="id72">
<h4>Parameters:<a class="headerlink" href="#id72" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id73">
<h4>Returns:<a class="headerlink" href="#id73" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Velocity perturbation (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.w_3p">
<span class="sig-name descname"><span class="pre">w_3p</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array([0.0687359,</span> <span class="pre">3.31435</span>&#160; <span class="pre">,</span> <span class="pre">2.29911</span>&#160; <span class="pre">],</span> <span class="pre">dtype=float64)</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.w_3p" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.w_5p">
<span class="sig-name descname"><span class="pre">w_5p</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array([0.0081201,</span> <span class="pre">0.689407</span> <span class="pre">,</span> <span class="pre">2.8063</span>&#160;&#160; <span class="pre">,</span> <span class="pre">2.05156</span>&#160; <span class="pre">,</span> <span class="pre">0.12681</span>&#160; <span class="pre">],</span> <span class="pre">dtype=float64)</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.w_5p" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.y_ini">
<span class="sig-name descname"><span class="pre">y_ini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">om</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.y_ini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.y_ini" title="Link to this definition">¶</a></dt>
<dd><p>Compute initial conditions for massive neutrino perturbations.</p>
<section id="id74">
<h4>Parameters:<a class="headerlink" href="#id74" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>tau_ini<span class="classifier">float</span></dt><dd><p>Initial conformal time (units: Mpc)</p>
</dd>
<dt>om<span class="classifier">float</span></dt><dd><p>Matter density parameter</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id75">
<h4>Returns:<a class="headerlink" href="#id75" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Initial perturbation mode values (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MassiveNeutrinos.y_prime">
<span class="sig-name descname"><span class="pre">y_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MassiveNeutrinos.y_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MassiveNeutrinos.y_prime" title="Link to this definition">¶</a></dt>
<dd><p>Compute time derivatives of massive neutrino perturbations.</p>
<section id="id76">
<h4>Parameters:<a class="headerlink" href="#id76" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>metric_h_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric h</p>
</dd>
<dt>metric_eta_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric eta</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Current perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id77">
<h4>Returns:<a class="headerlink" href="#id77" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Time derivatives of perturbation modes (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">MasslessNeutrinos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ell_modes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MasslessNeutrinos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractStandardPerturbedFluid</span></code></a></p>
<p>Massless neutrinos fluid species implementation.</p>
<p>Represents relativistic neutrinos with multiple angular momentum modes.</p>
<section id="id78">
<h3>Methods:<a class="headerlink" href="#id78" title="Link to this heading">¶</a></h3>
<p>rho : Compute neutrino density (units: eV cm^{-3})
P : Compute neutrino pressure (units: eV cm^{-3})
cs2 : Compute sound speed squared (units: dimensionless)</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos.P">
<span class="sig-name descname"><span class="pre">P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MasslessNeutrinos.P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos.P" title="Link to this definition">¶</a></dt>
<dd><p>Compute neutrino pressure.</p>
<section id="id79">
<h4>Parameters:<a class="headerlink" href="#id79" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id80">
<h4>Returns:<a class="headerlink" href="#id80" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Neutrino pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos.cs2">
<span class="sig-name descname"><span class="pre">cs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MasslessNeutrinos.cs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos.cs2" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound speed squared.</p>
<section id="id81">
<h4>Parameters:<a class="headerlink" href="#id81" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id82">
<h4>Returns:<a class="headerlink" href="#id82" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound speed squared (units: dimensionless)</p>
</dd>
</dl>
</section>
<section id="id83">
<h4>Notes:<a class="headerlink" href="#id83" title="Link to this heading">¶</a></h4>
<p>For massless neutrinos, sound speed is always 1/3 due to
their relativistic equation of state.</p>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos.delta_idx">
<span class="sig-name descname"><span class="pre">delta_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos.delta_idx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos.num_ell_modes">
<span class="sig-name descname"><span class="pre">num_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">7</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos.num_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos.rho">
<span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MasslessNeutrinos.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos.rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute neutrino density.</p>
<section id="id84">
<h4>Parameters:<a class="headerlink" href="#id84" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id85">
<h4>Returns:<a class="headerlink" href="#id85" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Neutrino density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos.y_ini">
<span class="sig-name descname"><span class="pre">y_ini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">om</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MasslessNeutrinos.y_ini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos.y_ini" title="Link to this definition">¶</a></dt>
<dd><p>Compute initial conditions for perturbation modes.</p>
<p>Calculates the initial state of perturbation modes at early cosmological times.</p>
<section id="id86">
<h4>Parameters:<a class="headerlink" href="#id86" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>tau_ini<span class="classifier">float</span></dt><dd><p>Initial conformal time (units: Mpc)</p>
</dd>
<dt>om<span class="classifier">float</span></dt><dd><p>Matter density parameter</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id87">
<h4>Returns:<a class="headerlink" href="#id87" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Initial perturbation mode values (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.MasslessNeutrinos.y_prime">
<span class="sig-name descname"><span class="pre">y_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#MasslessNeutrinos.y_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.MasslessNeutrinos.y_prime" title="Link to this definition">¶</a></dt>
<dd><p>Compute time derivatives of perturbation modes.</p>
<p>Calculates how perturbation modes evolve with cosmological time.</p>
<section id="id88">
<h4>Parameters:<a class="headerlink" href="#id88" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>metric_h_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric h</p>
</dd>
<dt>metric_eta_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric eta</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Current perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id89">
<h4>Returns:<a class="headerlink" href="#id89" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Time derivatives of perturbation modes (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.AbstractSpecies.</span></span><span class="sig-name descname"><span class="pre">Photon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baryon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_F_ell_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_G_ell_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Photon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractStandardPerturbedFluid"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractStandardPerturbedFluid</span></code></a></p>
<p>Photon fluid species implementation.</p>
<p>Relativistic photons with temperature and polarization Boltzmann hierarchies.</p>
<section id="id90">
<h3>Methods:<a class="headerlink" href="#id90" title="Link to this heading">¶</a></h3>
<p>rho : Compute photon density (units: eV cm^{-3})
P : Compute photon pressure (units: eV cm^{-3})
cs2 : Compute sound speed squared (units: dimensionless)
y_ini : Compute initial perturbation conditions (units: dimensionless)
y_prime : Compute perturbation time derivatives (units: dimensionless)</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.P">
<span class="sig-name descname"><span class="pre">P</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Photon.P"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.P" title="Link to this definition">¶</a></dt>
<dd><p>Compute photon pressure.</p>
<section id="id91">
<h4>Parameters:<a class="headerlink" href="#id91" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id92">
<h4>Returns:<a class="headerlink" href="#id92" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Photon pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.baryon">
<span class="sig-name descname"><span class="pre">baryon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ABCMB.AbstractSpecies.AbstractPerturbedFluid" title="ABCMB.AbstractSpecies.AbstractPerturbedFluid"><span class="pre">AbstractPerturbedFluid</span></a></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.baryon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.cs2">
<span class="sig-name descname"><span class="pre">cs2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Photon.cs2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.cs2" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound speed squared.</p>
<section id="id93">
<h4>Parameters:<a class="headerlink" href="#id93" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id94">
<h4>Returns:<a class="headerlink" href="#id94" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound speed squared (units: dimensionless)</p>
</dd>
</dl>
</section>
<section id="id95">
<h4>Notes:<a class="headerlink" href="#id95" title="Link to this heading">¶</a></h4>
<p>For photons, sound speed is always 1/3 due to their relativistic equation of state.</p>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.delta_idx">
<span class="sig-name descname"><span class="pre">delta_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.delta_idx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.num_F_ell_modes">
<span class="sig-name descname"><span class="pre">num_F_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.num_F_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.num_G_ell_modes">
<span class="sig-name descname"><span class="pre">num_G_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.num_G_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.num_ell_modes">
<span class="sig-name descname"><span class="pre">num_ell_modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.num_ell_modes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.rho">
<span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Photon.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute photon density.</p>
<section id="id96">
<h4>Parameters:<a class="headerlink" href="#id96" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id97">
<h4>Returns:<a class="headerlink" href="#id97" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Photon density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.y_ini">
<span class="sig-name descname"><span class="pre">y_ini</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_ini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">om</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Photon.y_ini"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.y_ini" title="Link to this definition">¶</a></dt>
<dd><p>Compute initial conditions for photon perturbations.</p>
<section id="id98">
<h4>Parameters:<a class="headerlink" href="#id98" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>tau_ini<span class="classifier">float</span></dt><dd><p>Initial conformal time (units: Mpc)</p>
</dd>
<dt>om<span class="classifier">float</span></dt><dd><p>Matter density parameter</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id99">
<h4>Returns:<a class="headerlink" href="#id99" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Initial perturbation mode values (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.AbstractSpecies.Photon.y_prime">
<span class="sig-name descname"><span class="pre">y_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta_prime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/AbstractSpecies.html#Photon.y_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.AbstractSpecies.Photon.y_prime" title="Link to this definition">¶</a></dt>
<dd><p>Compute time derivatives of photon perturbations.</p>
<section id="id100">
<h4>Parameters:<a class="headerlink" href="#id100" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>metric_h_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric h</p>
</dd>
<dt>metric_eta_prime<span class="classifier">float</span></dt><dd><p>Derivative of metric eta</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Current perturbation mode values</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id101">
<h4>Returns:<a class="headerlink" href="#id101" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Time derivatives of perturbation modes (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-ABCMB.constants">
<span id="abcmb-constants-module"></span><h2>ABCMB.constants module<a class="headerlink" href="#module-ABCMB.constants" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="ABCMB.constants.kB">
<span class="sig-prename descclassname"><span class="pre">ABCMB.constants.</span></span><span class="sig-name descname"><span class="pre">kB</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array(8.617343e-05,</span> <span class="pre">dtype=float64)</span></em><a class="headerlink" href="#ABCMB.constants.kB" title="Link to this definition">¶</a></dt>
<dd><p>Cosmology / particle physics related</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ABCMB.constants.mu_e">
<span class="sig-prename descclassname"><span class="pre">ABCMB.constants.</span></span><span class="sig-name descname"><span class="pre">mu_e</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array(510720.79143762,</span> <span class="pre">dtype=float64)</span></em><a class="headerlink" href="#ABCMB.constants.mu_e" title="Link to this definition">¶</a></dt>
<dd><p>Recombination related</p>
</dd></dl>

</section>
<section id="module-ABCMB.cosmology">
<span id="abcmb-cosmology-module"></span><h2>ABCMB.cosmology module<a class="headerlink" href="#module-ABCMB.cosmology" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.cosmology.</span></span><span class="sig-name descname"><span class="pre">Background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RM</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Background cosmology module for cosmological calculations.</p>
<p>Computes background quantities including Hubble parameter, conformal time,
recombination history, and optical depth evolution.</p>
<section id="recombination-unrelated-methods">
<h3>Recombination Unrelated Methods:<a class="headerlink" href="#recombination-unrelated-methods" title="Link to this heading">¶</a></h3>
<p>rho_tot : Compute total energy density (units: eV cm^{-3})
P_tot : Compute total pressure (units: eV cm^{-3})
H : Compute Hubble parameter (units: s^{-1})
aH : Compute conformal Hubble parameter (units: Mpc^{-1})
aH_prime : Compute derivative of conformal Hubble (units: Mpc^{-1})
d2adtau2_over_a : Compute second derivative of scale factor (units: Mpc^{-2})
tau : Compute conformal time (units: Mpc)
z_d : Compute baryon decoupling redshift (units: dimensionless)
rs_d : Compute sound horizon at decoupling (units: Mpc)</p>
</section>
<section id="recombination-related-methods">
<h3>Recombination Related Methods:<a class="headerlink" href="#recombination-related-methods" title="Link to this heading">¶</a></h3>
<p>xe : Compute free electron fraction (units: dimensionless)
Tm : Compute matter temperature (units: eV)
mu_bar : Compute mean molecular mass (units: eV)
cs2 : Compute baryon sound speed squared (units: dimensionless)
nH : Compute hydrogen number density (units: cm^{-3})
TCMB : Compute CMB temperature (units: eV)
tau_c : Compute Thomson scattering time (units: Mpc)
kappa : Compute optical depth (units: dimensionless)
visibility : Compute visibility function (units: Mpc^{-1})</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.H">
<span class="sig-name descname"><span class="pre">H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.H"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.H" title="Link to this definition">¶</a></dt>
<dd><p>Compute Hubble parameter.</p>
<p>Uses Einstein equation H = sqrt(8πG/3 ρ_tot) to account for
novel species without well-defined density parameters.</p>
<section id="id102">
<h4>Parameters:<a class="headerlink" href="#id102" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id103">
<h4>Returns:<a class="headerlink" href="#id103" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Hubble parameter (units: s^{-1})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.P_tot">
<span class="sig-name descname"><span class="pre">P_tot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.P_tot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.P_tot" title="Link to this definition">¶</a></dt>
<dd><p>Compute total pressure.</p>
<p>Sums pressure over all species in the universe.</p>
<section id="id104">
<h4>Parameters:<a class="headerlink" href="#id104" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id105">
<h4>Returns:<a class="headerlink" href="#id105" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Total pressure (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
<section id="id106">
<h4>Notes:<a class="headerlink" href="#id106" title="Link to this heading">¶</a></h4>
<p>User should not modify this function without careful consideration.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.R_ratio_lna">
<span class="sig-name descname"><span class="pre">R_ratio_lna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.R_ratio_lna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.R_ratio_lna" title="Link to this definition">¶</a></dt>
<dd><p>Compute baryon drag ratio.</p>
<p>Calculates R = 3ρ_b/(4ρ_γ), the ratio of baryon to photon
energy densities that appears in baryon drag calculations.</p>
<section id="id107">
<h4>Parameters:<a class="headerlink" href="#id107" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id108">
<h4>Returns:<a class="headerlink" href="#id108" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Baryon drag ratio (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.TCMB">
<span class="sig-name descname"><span class="pre">TCMB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.TCMB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.TCMB" title="Link to this definition">¶</a></dt>
<dd><p>Compute CMB temperature.</p>
<p>Calculates CMB temperature at given redshift using T ∝ 1/a scaling.</p>
<section id="id109">
<h4>Parameters:<a class="headerlink" href="#id109" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id110">
<h4>Returns:<a class="headerlink" href="#id110" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>CMB temperature (units: eV)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.Tm">
<span class="sig-name descname"><span class="pre">Tm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.Tm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.Tm" title="Link to this definition">¶</a></dt>
<dd><p>Compute matter temperature.</p>
<p>Interpolates from pre-tabulated recombination history with
early-time approximation and late-time boundary conditions.</p>
<section id="id111">
<h4>Parameters:<a class="headerlink" href="#id111" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id112">
<h4>Returns:<a class="headerlink" href="#id112" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Matter temperature (units: eV)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.Tm_tab">
<span class="sig-name descname"><span class="pre">Tm_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding" title="ABCMB.hyrax.array_with_padding.array_with_padding"><span class="pre">array_with_padding</span></a></em><a class="headerlink" href="#ABCMB.cosmology.Background.Tm_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.aH">
<span class="sig-name descname"><span class="pre">aH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.aH"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.aH" title="Link to this definition">¶</a></dt>
<dd><p>Compute conformal Hubble parameter.</p>
<p>Calculates conformal Hubble H = a*H = da/dτ where τ is conformal time.
Uses Mpc units for perturbation calculations.</p>
<section id="id113">
<h4>Parameters:<a class="headerlink" href="#id113" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id114">
<h4>Returns:<a class="headerlink" href="#id114" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Conformal Hubble parameter (units: Mpc^{-1})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.aH_prime">
<span class="sig-name descname"><span class="pre">aH_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.aH_prime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.aH_prime" title="Link to this definition">¶</a></dt>
<dd><p>Compute derivative of conformal Hubble parameter.</p>
<p>Uses second Friedmann equation to compute d(aH)/d(ln a).
See Eq.(20) of arXiv:9506072.</p>
<section id="id115">
<h4>Parameters:<a class="headerlink" href="#id115" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id116">
<h4>Returns:<a class="headerlink" href="#id116" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Derivative of conformal Hubble (units: Mpc^{-1})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.d2adtau2_over_a">
<span class="sig-name descname"><span class="pre">d2adtau2_over_a</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.d2adtau2_over_a"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.d2adtau2_over_a" title="Link to this definition">¶</a></dt>
<dd><p>Compute second derivative of scale factor.</p>
<p>Calculates d²a/dτ²/a where τ is conformal time.
Appears in perturbation evolution equations.</p>
<section id="id117">
<h4>Parameters:<a class="headerlink" href="#id117" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id118">
<h4>Returns:<a class="headerlink" href="#id118" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Second derivative of scale factor (units: Mpc^{-2})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.find_z_at_kappad_equals_one">
<span class="sig-name descname"><span class="pre">find_z_at_kappad_equals_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.find_z_at_kappad_equals_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.find_z_at_kappad_equals_one" title="Link to this definition">¶</a></dt>
<dd><p>Find redshift where baryon optical depth equals unity.</p>
<p>Interpolates to find z_d such that κ_d(z_d) = 1, marking
the approximate time of baryon decoupling.</p>
<section id="id119">
<h4>Parameters:<a class="headerlink" href="#id119" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>z<span class="classifier">array</span></dt><dd><p>Redshift array</p>
</dd>
<dt>kappa_d<span class="classifier">array</span></dt><dd><p>Baryon optical depth array</p>
</dd>
</dl>
</section>
<section id="id120">
<h4>Returns:<a class="headerlink" href="#id120" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Decoupling redshift (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.interp_rs_at_z">
<span class="sig-name descname"><span class="pre">interp_rs_at_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_bg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.interp_rs_at_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.interp_rs_at_z" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate sound horizon at decoupling redshift.</p>
<section id="id121">
<h4>Parameters:<a class="headerlink" href="#id121" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>z_bg<span class="classifier">array</span></dt><dd><p>Background redshift array</p>
</dd>
<dt>r_s<span class="classifier">array</span></dt><dd><p>Sound horizon array</p>
</dd>
<dt>z_d<span class="classifier">float</span></dt><dd><p>Decoupling redshift</p>
</dd>
</dl>
</section>
<section id="id122">
<h4>Returns:<a class="headerlink" href="#id122" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound horizon at decoupling (units: Mpc)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.kappa">
<span class="sig-name descname"><span class="pre">kappa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.kappa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.kappa" title="Link to this definition">¶</a></dt>
<dd><p>Compute optical depth.</p>
<p>Interpolates from pre-tabulated optical depth history.</p>
<section id="id123">
<h4>Parameters:<a class="headerlink" href="#id123" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id124">
<h4>Returns:<a class="headerlink" href="#id124" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Optical depth (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.kappa_tab">
<span class="sig-name descname"><span class="pre">kappa_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.kappa_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.lna_Tm_tab">
<span class="sig-name descname"><span class="pre">lna_Tm_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding" title="ABCMB.hyrax.array_with_padding.array_with_padding"><span class="pre">array_with_padding</span></a></em><a class="headerlink" href="#ABCMB.cosmology.Background.lna_Tm_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.lna_rec">
<span class="sig-name descname"><span class="pre">lna_rec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.lna_rec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.lna_tau_tab">
<span class="sig-name descname"><span class="pre">lna_tau_tab</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Array([-3.30000000e+01,</span> <span class="pre">-3.29966997e+01,</span> <span class="pre">-3.29933993e+01,</span> <span class="pre">...,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-6.60066007e-03,</span> <span class="pre">-3.30033003e-03,</span>&#160; <span class="pre">0.00000000e+00],</span> <span class="pre">dtype=float64)</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.lna_tau_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.lna_transfer_start">
<span class="sig-name descname"><span class="pre">lna_transfer_start</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.lna_transfer_start" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.lna_visibility_stop">
<span class="sig-name descname"><span class="pre">lna_visibility_stop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.lna_visibility_stop" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.lna_xe_tab">
<span class="sig-name descname"><span class="pre">lna_xe_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding" title="ABCMB.hyrax.array_with_padding.array_with_padding"><span class="pre">array_with_padding</span></a></em><a class="headerlink" href="#ABCMB.cosmology.Background.lna_xe_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.nH">
<span class="sig-name descname"><span class="pre">nH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.nH"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.nH" title="Link to this definition">¶</a></dt>
<dd><p>Compute hydrogen number density.</p>
<p>Calculates total hydrogen number density at given redshift.</p>
<section id="id125">
<h4>Parameters:<a class="headerlink" href="#id125" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id126">
<h4>Returns:<a class="headerlink" href="#id126" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Hydrogen number density (units: cm^{-3})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.rA_rec">
<span class="sig-name descname"><span class="pre">rA_rec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.rA_rec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.rho_tot">
<span class="sig-name descname"><span class="pre">rho_tot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.rho_tot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.rho_tot" title="Link to this definition">¶</a></dt>
<dd><p>Compute total energy density.</p>
<p>Sums energy density over all species in the universe.</p>
<section id="id127">
<h4>Parameters:<a class="headerlink" href="#id127" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id128">
<h4>Returns:<a class="headerlink" href="#id128" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Total energy density (units: eV cm^{-3})</p>
</dd>
</dl>
</section>
<section id="id129">
<h4>Notes:<a class="headerlink" href="#id129" title="Link to this heading">¶</a></h4>
<p>User should not modify this function without careful consideration.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.rs_d">
<span class="sig-name descname"><span class="pre">rs_d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.rs_d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.rs_d" title="Link to this definition">¶</a></dt>
<dd><p>Compute sound horizon at decoupling.</p>
<p>Finds value of sound horizon at baryon decoupling redshift z_d.</p>
<section id="id130">
<h4>Returns:<a class="headerlink" href="#id130" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Sound horizon at decoupling (units: Mpc)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.species_list">
<span class="sig-name descname"><span class="pre">species_list</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.species_list" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.tau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.tau" title="Link to this definition">¶</a></dt>
<dd><p>Compute conformal time.</p>
<p>Interpolates from pre-tabulated conformal time history.
Conformal time τ satisfies dτ = dt/a where t is cosmic time.</p>
<section id="id131">
<h4>Parameters:<a class="headerlink" href="#id131" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id132">
<h4>Returns:<a class="headerlink" href="#id132" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Conformal time (units: Mpc)</p>
</dd>
</dl>
</section>
<section id="id133">
<h4>Notes:<a class="headerlink" href="#id133" title="Link to this heading">¶</a></h4>
<p>IDEA: Make Background a repeatedly initiated module with both
species_list and params stored. Upon initiation, a full history
of conformal time is calculated with diffrax and stored for
interpolation. This can be done by approximating early time with
radiation approximation, and starting diffrax integration at the
early time with appropriate initial conditions.</p>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.tau0">
<span class="sig-name descname"><span class="pre">tau0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.tau0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.tau_c">
<span class="sig-name descname"><span class="pre">tau_c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.tau_c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.tau_c" title="Link to this definition">¶</a></dt>
<dd><p>Compute Thomson scattering time.</p>
<p>Calculates Thomson scattering time scale τc = 1/(a × ne × σT).</p>
<section id="id134">
<h4>Parameters:<a class="headerlink" href="#id134" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id135">
<h4>Returns:<a class="headerlink" href="#id135" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Thomson scattering time (units: Mpc)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.tau_tab">
<span class="sig-name descname"><span class="pre">tau_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.cosmology.Background.tau_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.visibility">
<span class="sig-name descname"><span class="pre">visibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.visibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.visibility" title="Link to this definition">¶</a></dt>
<dd><p>Compute visibility function.</p>
<p>Calculates visibility function g(x) = -aH(x) × κ’(x) × exp(-κ(x))
where ‘ = d/dx and x = ln a. Represents probability that a CMB
photon observed today was last scattered at time x.</p>
<section id="id136">
<h4>Parameters:<a class="headerlink" href="#id136" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id137">
<h4>Returns:<a class="headerlink" href="#id137" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Visibility function (units: Mpc^{-1})</p>
</dd>
</dl>
</section>
<section id="id138">
<h4>Notes:<a class="headerlink" href="#id138" title="Link to this heading">¶</a></h4>
<p>Used in computing source functions for CMB anisotropies.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.xe">
<span class="sig-name descname"><span class="pre">xe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.xe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.xe" title="Link to this definition">¶</a></dt>
<dd><p>Compute free electron fraction.</p>
<p>Interpolates from pre-tabulated recombination history with
boundary conditions for early and late times.</p>
<section id="id139">
<h4>Parameters:<a class="headerlink" href="#id139" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id140">
<h4>Returns:<a class="headerlink" href="#id140" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Free electron fraction (units: dimensionless)</p>
</dd>
</dl>
</section>
<section id="id141">
<h4>Notes:<a class="headerlink" href="#id141" title="Link to this heading">¶</a></h4>
<p>The logic flow is equivalent to:
if lna &lt; self.lna_xe_tab.arr[0]:</p>
<blockquote>
<div><p>return self.xe_tab[0]</p>
</div></blockquote>
<dl class="simple">
<dt>elif lna &gt; self.lna_xe_tab.lastval</dt><dd><p>return self.xe_tab.lastval</p>
</dd>
<dt>else</dt><dd><p>return jnp.interp(lna, self.lna_xe_tab, self.xe_tab)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.xe_tab">
<span class="sig-name descname"><span class="pre">xe_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.array_with_padding.array_with_padding" title="ABCMB.hyrax.array_with_padding.array_with_padding"><span class="pre">array_with_padding</span></a></em><a class="headerlink" href="#ABCMB.cosmology.Background.xe_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.Background.z_d">
<span class="sig-name descname"><span class="pre">z_d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#Background.z_d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.Background.z_d" title="Link to this definition">¶</a></dt>
<dd><p>Compute baryon decoupling redshift.</p>
<p>Finds redshift where κ_d = 1 as estimate of when baryons
decouple from photons.</p>
<section id="id142">
<h4>Returns:<a class="headerlink" href="#id142" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Decoupling redshift (units: dimensionless)</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.cosmology.ClassBackground">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.cosmology.</span></span><span class="sig-name descname"><span class="pre">ClassBackground</span></span><a class="reference internal" href="_modules/ABCMB/cosmology.html#ClassBackground"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.ClassBackground" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.cosmology.Background" title="ABCMB.cosmology.Background"><code class="xref py py-class docutils literal notranslate"><span class="pre">Background</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.ClassBackground.H">
<span class="sig-name descname"><span class="pre">H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#ClassBackground.H"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.ClassBackground.H" title="Link to this definition">¶</a></dt>
<dd><p>Compute Hubble parameter.</p>
<p>Uses Einstein equation H = sqrt(8πG/3 ρ_tot) to account for
novel species without well-defined density parameters.</p>
<section id="id143">
<h3>Parameters:<a class="headerlink" href="#id143" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id144">
<h3>Returns:<a class="headerlink" href="#id144" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>Hubble parameter (units: s^{-1})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.ClassBackground.H_tab">
<span class="sig-name descname"><span class="pre">H_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.cosmology.ClassBackground.H_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.ClassBackground.Tm">
<span class="sig-name descname"><span class="pre">Tm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#ClassBackground.Tm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.ClassBackground.Tm" title="Link to this definition">¶</a></dt>
<dd><p>Compute matter temperature.</p>
<p>Interpolates from pre-tabulated recombination history with
early-time approximation and late-time boundary conditions.</p>
<section id="id145">
<h3>Parameters:<a class="headerlink" href="#id145" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id146">
<h3>Returns:<a class="headerlink" href="#id146" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>Matter temperature (units: eV)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.ClassBackground.xe">
<span class="sig-name descname"><span class="pre">xe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#ClassBackground.xe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.ClassBackground.xe" title="Link to this definition">¶</a></dt>
<dd><p>Compute free electron fraction.</p>
<p>Interpolates from pre-tabulated recombination history with
boundary conditions for early and late times.</p>
<section id="id147">
<h3>Parameters:<a class="headerlink" href="#id147" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id148">
<h3>Returns:<a class="headerlink" href="#id148" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>Free electron fraction (units: dimensionless)</p>
</dd>
</dl>
</section>
<section id="id149">
<h3>Notes:<a class="headerlink" href="#id149" title="Link to this heading">¶</a></h3>
<p>The logic flow is equivalent to:
if lna &lt; self.lna_xe_tab.arr[0]:</p>
<blockquote>
<div><p>return self.xe_tab[0]</p>
</div></blockquote>
<dl class="simple">
<dt>elif lna &gt; self.lna_xe_tab.lastval</dt><dd><p>return self.xe_tab.lastval</p>
</dd>
<dt>else</dt><dd><p>return jnp.interp(lna, self.lna_xe_tab, self.xe_tab)</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.cosmology.MockBackground">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.cosmology.</span></span><span class="sig-name descname"><span class="pre">MockBackground</span></span><a class="reference internal" href="_modules/ABCMB/cosmology.html#MockBackground"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.MockBackground" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.cosmology.Background" title="ABCMB.cosmology.Background"><code class="xref py py-class docutils literal notranslate"><span class="pre">Background</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.cosmology.MockBackground.H">
<span class="sig-name descname"><span class="pre">H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/cosmology.html#MockBackground.H"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.cosmology.MockBackground.H" title="Link to this definition">¶</a></dt>
<dd><p>Compute Hubble parameter.</p>
<p>Uses Einstein equation H = sqrt(8πG/3 ρ_tot) to account for
novel species without well-defined density parameters.</p>
<section id="id150">
<h3>Parameters:<a class="headerlink" href="#id150" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id151">
<h3>Returns:<a class="headerlink" href="#id151" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>Hubble parameter (units: s^{-1})</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.cosmology.MockBackground.H_tab">
<span class="sig-name descname"><span class="pre">H_tab</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.cosmology.MockBackground.H_tab" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-ABCMB.main">
<span id="abcmb-main-module"></span><h2>ABCMB.main module<a class="headerlink" href="#module-ABCMB.main" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.main.Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.main.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ellmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ellmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lensing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_MasslessNeutrinos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_MassiveNeutrinos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/main.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.main.Model" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Model configuration and computation manager.</p>
<p>Creates instances of fluid species based on user input and organizes
them for computation. Manages the full pipeline from background
evolution through CMB power spectrum computation.</p>
<section id="id152">
<h3>Methods:<a class="headerlink" href="#id152" title="Link to this heading">¶</a></h3>
<p>run_cosmology : Compute CMB angular power spectra
get_PTBG : Get perturbation table and background cosmology
get_BG : Get background cosmology
add_derived_parameters : Compute derived parameters</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Model.RM">
<span class="sig-name descname"><span class="pre">RM</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="ABCMB.hyrax.html#ABCMB.hyrax.hyrax.recomb_model" title="ABCMB.hyrax.hyrax.recomb_model"><span class="pre">recomb_model</span></a></em><a class="headerlink" href="#ABCMB.main.Model.RM" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Model.SS">
<span class="sig-name descname"><span class="pre">SS</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ABCMB.spectrum.SpectrumSolver" title="ABCMB.spectrum.SpectrumSolver"><span class="pre">SpectrumSolver</span></a></em><a class="headerlink" href="#ABCMB.main.Model.SS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.main.Model.add_derived_parameters">
<span class="sig-name descname"><span class="pre">add_derived_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/ABCMB/main.html#Model.add_derived_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.main.Model.add_derived_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Compute derived parameters.</p>
<p>Calculates derived parameters from the fundamental parameters,
including density parameters and ratios.</p>
<section id="id153">
<h4>Parameters:<a class="headerlink" href="#id153" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>params<span class="classifier">dict</span></dt><dd><p>Input parameters</p>
</dd>
</dl>
</section>
<section id="id154">
<h4>Returns:<a class="headerlink" href="#id154" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>dict</dt><dd><p>Extended parameter dictionary with derived quantities</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.main.Model.get_BG">
<span class="sig-name descname"><span class="pre">get_BG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/main.html#Model.get_BG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.main.Model.get_BG" title="Link to this definition">¶</a></dt>
<dd><p>Get background for given parameters.</p>
<section id="id155">
<h4>Parameters:<a class="headerlink" href="#id155" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>params<span class="classifier">dict</span></dt><dd><p>Cosmological parameters</p>
</dd>
</dl>
</section>
<section id="id156">
<h4>Returns:<a class="headerlink" href="#id156" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>cosmology.Background</dt><dd><p>Background object</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.main.Model.get_PTBG">
<span class="sig-name descname"><span class="pre">get_PTBG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/main.html#Model.get_PTBG"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.main.Model.get_PTBG" title="Link to this definition">¶</a></dt>
<dd><p>Get perturbation table and background.</p>
<p>Computes background and evolves perturbations for the given parameters.</p>
<section id="id157">
<h4>Parameters:<a class="headerlink" href="#id157" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>params<span class="classifier">dict</span></dt><dd><p>Cosmological parameters</p>
</dd>
</dl>
</section>
<section id="id158">
<h4>Returns:<a class="headerlink" href="#id158" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>tuple</dt><dd><p>(PerturbationTable, Background) objects</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Model.perturbations_list">
<span class="sig-name descname"><span class="pre">perturbations_list</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></em><a class="headerlink" href="#ABCMB.main.Model.perturbations_list" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.main.Model.run_cosmology">
<span class="sig-name descname"><span class="pre">run_cosmology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/main.html#Model.run_cosmology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.main.Model.run_cosmology" title="Link to this definition">¶</a></dt>
<dd><p>Compute CMB angular power spectra for given parameters.</p>
<p>Runs the full pipeline from background evolution through
perturbation integration to CMB power spectrum computation.</p>
<section id="id159">
<h4>Parameters:<a class="headerlink" href="#id159" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>params<span class="classifier">dict</span></dt><dd><p>Cosmological parameters</p>
</dd>
</dl>
</section>
<section id="id160">
<h4>Returns:<a class="headerlink" href="#id160" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>tuple</dt><dd><p>(ℓ values, (C_ℓ^TT, C_ℓ^TE, C_ℓ^EE)) for computed multipoles</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Model.species_list">
<span class="sig-name descname"><span class="pre">species_list</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></em><a class="headerlink" href="#ABCMB.main.Model.species_list" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.main.Precision">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.main.</span></span><span class="sig-name descname"><span class="pre">Precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T0_largek_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1_largek_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.04</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2_largek_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E0_largek_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_c_over_tau_h_largex_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.008</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jl_smallx_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/main.html#Precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.main.Precision" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Computational precision parameters.</p>
<p>Contains constants for transfer function calculations and
line-of-sight integrals.</p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>T0_largek_cut<span class="classifier">float</span></dt><dd><p>T0 term k-space cutoff (units: Mpc^{-1})</p>
</dd>
<dt>T1_largek_cut<span class="classifier">float</span></dt><dd><p>T1 term k-space cutoff (units: Mpc^{-1})</p>
</dd>
<dt>T2_largek_cut<span class="classifier">float</span></dt><dd><p>T2 term k-space cutoff (units: Mpc^{-1})</p>
</dd>
<dt>E0_largek_cut<span class="classifier">float</span></dt><dd><p>E-mode polarization k-space cutoff (units: Mpc^{-1})</p>
</dd>
<dt>tau_c_over_tau_h_largex_cut<span class="classifier">float</span></dt><dd><p>Thomson scattering time threshold</p>
</dd>
<dt>jl_smallx_cut<span class="classifier">float</span></dt><dd><p>Spherical Bessel function cutoff threshold</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Precision.E0_largek_cut">
<span class="sig-name descname"><span class="pre">E0_largek_cut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.11</span></em><a class="headerlink" href="#ABCMB.main.Precision.E0_largek_cut" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Precision.T0_largek_cut">
<span class="sig-name descname"><span class="pre">T0_largek_cut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.15</span></em><a class="headerlink" href="#ABCMB.main.Precision.T0_largek_cut" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Precision.T1_largek_cut">
<span class="sig-name descname"><span class="pre">T1_largek_cut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.04</span></em><a class="headerlink" href="#ABCMB.main.Precision.T1_largek_cut" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Precision.T2_largek_cut">
<span class="sig-name descname"><span class="pre">T2_largek_cut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.15</span></em><a class="headerlink" href="#ABCMB.main.Precision.T2_largek_cut" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Precision.jl_smallx_cut">
<span class="sig-name descname"><span class="pre">jl_smallx_cut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#ABCMB.main.Precision.jl_smallx_cut" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.main.Precision.tau_c_over_tau_h_largex_cut">
<span class="sig-name descname"><span class="pre">tau_c_over_tau_h_largex_cut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.008</span></em><a class="headerlink" href="#ABCMB.main.Precision.tau_c_over_tau_h_largex_cut" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

</section>
<section id="module-ABCMB.perturbations">
<span id="abcmb-perturbations-module"></span><h2>ABCMB.perturbations module<a class="headerlink" href="#module-ABCMB.perturbations" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.perturbations.MockPerturbationTable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.perturbations.</span></span><span class="sig-name descname"><span class="pre">MockPerturbationTable</span></span><a class="reference internal" href="_modules/ABCMB/perturbations.html#MockPerturbationTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.MockPerturbationTable" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ABCMB.perturbations.PerturbationTable" title="ABCMB.perturbations.PerturbationTable"><code class="xref py py-class docutils literal notranslate"><span class="pre">PerturbationTable</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.perturbations.</span></span><span class="sig-name descname"><span class="pre">PerturbationEvolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perturbations_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ABCMB.cosmology.Background" title="ABCMB.cosmology.Background"><span class="pre">cosmology.Background</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Linear scalar perturbation evolution solver.</p>
<p>Evolves perturbations for all fluid species using Einstein-Boltzmann
equations in synchronous gauge.</p>
<section id="id161">
<h3>Methods:<a class="headerlink" href="#id161" title="Link to this heading">¶</a></h3>
<p>full_evolution : Evolve perturbations for multiple k modes
evolution_one_k : Evolve perturbations for single k mode
get_tca_on_off : Determine tight coupling approximation times
initial_conditions_one_k : Compute initial perturbation conditions
get_derivatives : Compute perturbation time derivatives
make_output_table : Create interpolatable perturbation table</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.BG">
<span class="sig-name descname"><span class="pre">BG</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#ABCMB.cosmology.Background" title="ABCMB.cosmology.Background"><span class="pre">cosmology.Background</span></a></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.BG" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.evolution_one_k">
<span class="sig-name descname"><span class="pre">evolution_one_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.evolution_one_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.evolution_one_k" title="Link to this definition">¶</a></dt>
<dd><p>Evolve perturbations for single wavenumber mode.</p>
<p>Integrates Einstein-Boltzmann equations from early times through
recombination to late times using adaptive time stepping.</p>
<section id="id162">
<h4>Parameters:<a class="headerlink" href="#id162" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
</dl>
</section>
<section id="id163">
<h4>Returns:<a class="headerlink" href="#id163" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>diffrax.Solution</dt><dd><p>Dense solution object for interpolation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.evolution_one_k_scan">
<span class="sig-name descname"><span class="pre">evolution_one_k_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.evolution_one_k_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.evolution_one_k_scan" title="Link to this definition">¶</a></dt>
<dd><p>Evolve perturbations for single wavenumber mode.</p>
<p>Integrates Einstein-Boltzmann equations from early times through
recombination to late times using adaptive time stepping.</p>
<section id="id164">
<h4>Parameters:<a class="headerlink" href="#id164" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
</dl>
</section>
<section id="id165">
<h4>Returns:<a class="headerlink" href="#id165" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>diffrax.Solution</dt><dd><p>Dense solution object for interpolation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.full_evolution">
<span class="sig-name descname"><span class="pre">full_evolution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.full_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.full_evolution" title="Link to this definition">¶</a></dt>
<dd><p>Evolve perturbations for multiple wavenumber modes.</p>
<p>Integrates perturbation equations for a range of k modes,
then interpolates results onto common time grid.</p>
<section id="id166">
<h4>Returns:<a class="headerlink" href="#id166" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>PerturbationTable</dt><dd><p>Interpolatable table of perturbation evolution</p>
</dd>
</dl>
</section>
<section id="id167">
<h4>Notes:<a class="headerlink" href="#id167" title="Link to this heading">¶</a></h4>
<p>Uses logarithmic k spacing from 10^-4 to ~0.5 Mpc^-1 with 100 points.
Time integration runs from early times to z=1 (lna=-ln(2)).</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.full_evolution_scan">
<span class="sig-name descname"><span class="pre">full_evolution_scan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.full_evolution_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.full_evolution_scan" title="Link to this definition">¶</a></dt>
<dd><p>Evolve perturbations for multiple wavenumber modes.</p>
<p>Integrates perturbation equations for a range of k modes,
then interpolates results onto common time grid.</p>
<section id="id168">
<h4>Returns:<a class="headerlink" href="#id168" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>PerturbationTable</dt><dd><p>Interpolatable table of perturbation evolution</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.get_derivatives">
<span class="sig-name descname"><span class="pre">get_derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.get_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.get_derivatives" title="Link to this definition">¶</a></dt>
<dd><p>Compute time derivatives for perturbation evolution.</p>
<p>Assembles the full system of Einstein-Boltzmann equations for
metric and fluid perturbations in synchronous gauge.</p>
<section id="id169">
<h4>Parameters:<a class="headerlink" href="#id169" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>lna<span class="classifier">float</span></dt><dd><p>Logarithm of scale factor</p>
</dd>
<dt>y<span class="classifier">array</span></dt><dd><p>Current perturbation state vector</p>
</dd>
<dt>args<span class="classifier">float</span></dt><dd><p>Wavenumber k (units: Mpc^{-1})</p>
</dd>
</dl>
</section>
<section id="id170">
<h4>Returns:<a class="headerlink" href="#id170" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Time derivatives of perturbation state</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.get_tca_on_off">
<span class="sig-name descname"><span class="pre">get_tca_on_off</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.get_tca_on_off"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.get_tca_on_off" title="Link to this definition">¶</a></dt>
<dd><p>Determine tight coupling approximation time range.</p>
<p>Finds start and end times for tight coupling between photons and baryons
by computing when Thomson scattering becomes ineffective relative to
Hubble and horizon crossing time scales.</p>
<section id="id171">
<h4>Parameters:<a class="headerlink" href="#id171" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
</dl>
</section>
<section id="id172">
<h4>Returns:<a class="headerlink" href="#id172" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>tuple</dt><dd><p>(lna_start, lna_end) for tight coupling period</p>
</dd>
</dl>
</section>
<section id="id173">
<h4>Notes:<a class="headerlink" href="#id173" title="Link to this heading">¶</a></h4>
<p>Uses thresholds: τc/τh &lt; 0.0015 (start), τh/τk &lt; 0.07 (start),
τc/τh &gt; 0.015 (end), τc/τk &gt; 0.01 (end).</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.initial_conditions_one_k">
<span class="sig-name descname"><span class="pre">initial_conditions_one_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_ini</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.initial_conditions_one_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.initial_conditions_one_k" title="Link to this definition">¶</a></dt>
<dd><p>Compute initial conditions for perturbation evolution.</p>
<p>Sets up initial values for metric and fluid perturbations at early times
using adiabatic initial conditions.</p>
<section id="id174">
<h4>Parameters:<a class="headerlink" href="#id174" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna_ini<span class="classifier">float</span></dt><dd><p>Initial logarithm of scale factor</p>
</dd>
</dl>
</section>
<section id="id175">
<h4>Returns:<a class="headerlink" href="#id175" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>array</dt><dd><p>Initial perturbation state vector</p>
</dd>
</dl>
</section>
<section id="id176">
<h4>Notes:<a class="headerlink" href="#id176" title="Link to this heading">¶</a></h4>
<p>Uses CLASS-style initial conditions with metric perturbations h and η.
Assumes adiabatic initial conditions with vanishing isocurvature modes.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.make_output_table">
<span class="sig-name descname"><span class="pre">make_output_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationEvolver.make_output_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.make_output_table" title="Link to this definition">¶</a></dt>
<dd><p>Create interpolatable perturbation table from evolution results.</p>
<p>Extracts key perturbation modes and computes derived quantities.</p>
<section id="id177">
<h4>Parameters:<a class="headerlink" href="#id177" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">array</span></dt><dd><p>Wavenumber grid (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">array</span></dt><dd><p>Logarithm of scale factor grid</p>
</dd>
<dt>modes<span class="classifier">array</span></dt><dd><p>Perturbation evolution results</p>
</dd>
</dl>
</section>
<section id="id178">
<h4>Returns:<a class="headerlink" href="#id178" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>PerturbationTable</dt><dd><p>Organized perturbation data for interpolation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationEvolver.perturbations_list">
<span class="sig-name descname"><span class="pre">perturbations_list</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationEvolver.perturbations_list" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.perturbations.</span></span><span class="sig-name descname"><span class="pre">PerturbationTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_cdm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_b_prime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gg0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gg2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_h_prime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_eta_prime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_alpha_prime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/perturbations.html#PerturbationTable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Interpolatable table of perturbation evolution.</p>
<p>Stores perturbation modes as 2D arrays over wavenumber and time
for efficient interpolation.</p>
<section id="id179">
<h3>Attributes:<a class="headerlink" href="#id179" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>k<span class="classifier">array</span></dt><dd><p>Wavenumber grid (units: Mpc^{-1})</p>
</dd>
<dt>lna<span class="classifier">array</span></dt><dd><p>Logarithm of scale factor grid</p>
</dd>
<dt>delta_cdm<span class="classifier">array</span></dt><dd><p>Cold dark matter density perturbations</p>
</dd>
<dt>delta_b<span class="classifier">array</span></dt><dd><p>Baryon density perturbations</p>
</dd>
<dt>theta_b<span class="classifier">array</span></dt><dd><p>Baryon velocity perturbations</p>
</dd>
<dt>theta_b_prime<span class="classifier">array</span></dt><dd><p>Baryon velocity derivatives</p>
</dd>
<dt>delta_g<span class="classifier">array</span></dt><dd><p>Photon density perturbations</p>
</dd>
<dt>theta_g<span class="classifier">array</span></dt><dd><p>Photon velocity perturbations</p>
</dd>
<dt>sigma_g<span class="classifier">array</span></dt><dd><p>Photon quadrupole temperature moments</p>
</dd>
<dt>Gg0<span class="classifier">array</span></dt><dd><p>Photon monopole polarization moments</p>
</dd>
<dt>Gg2<span class="classifier">array</span></dt><dd><p>Photon quadrupole polarization moments</p>
</dd>
<dt>metric_h<span class="classifier">array</span></dt><dd><p>Metric perturbation h</p>
</dd>
<dt>metric_eta<span class="classifier">array</span></dt><dd><p>Metric perturbation η</p>
</dd>
<dt>metric_h_prime<span class="classifier">array</span></dt><dd><p>Time derivative of metric h</p>
</dd>
<dt>metric_eta_prime<span class="classifier">array</span></dt><dd><p>Time derivative of metric η</p>
</dd>
<dt>metric_alpha<span class="classifier">array</span></dt><dd><p>Derived metric perturbation α</p>
</dd>
<dt>metric_alpha_prime<span class="classifier">array</span></dt><dd><p>Time derivative of metric α</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.Gg0">
<span class="sig-name descname"><span class="pre">Gg0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.Gg0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.Gg2">
<span class="sig-name descname"><span class="pre">Gg2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.Gg2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.delta_b">
<span class="sig-name descname"><span class="pre">delta_b</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.delta_b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.delta_cdm">
<span class="sig-name descname"><span class="pre">delta_cdm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.delta_cdm" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.delta_g">
<span class="sig-name descname"><span class="pre">delta_g</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.delta_g" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.k">
<span class="sig-name descname"><span class="pre">k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.k" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.lna">
<span class="sig-name descname"><span class="pre">lna</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.lna" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.metric_alpha">
<span class="sig-name descname"><span class="pre">metric_alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.metric_alpha" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.metric_alpha_prime">
<span class="sig-name descname"><span class="pre">metric_alpha_prime</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.metric_alpha_prime" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.metric_eta">
<span class="sig-name descname"><span class="pre">metric_eta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.metric_eta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.metric_eta_prime">
<span class="sig-name descname"><span class="pre">metric_eta_prime</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.metric_eta_prime" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.metric_h">
<span class="sig-name descname"><span class="pre">metric_h</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.metric_h" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.metric_h_prime">
<span class="sig-name descname"><span class="pre">metric_h_prime</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.metric_h_prime" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.sigma_g">
<span class="sig-name descname"><span class="pre">sigma_g</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.sigma_g" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.theta_b">
<span class="sig-name descname"><span class="pre">theta_b</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.theta_b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.theta_b_prime">
<span class="sig-name descname"><span class="pre">theta_b_prime</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.theta_b_prime" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.perturbations.PerturbationTable.theta_g">
<span class="sig-name descname"><span class="pre">theta_g</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.perturbations.PerturbationTable.theta_g" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

</section>
<section id="module-ABCMB.spectrum">
<span id="abcmb-spectrum-module"></span><h2>ABCMB.spectrum module<a class="headerlink" href="#module-ABCMB.spectrum" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ABCMB.spectrum.</span></span><span class="sig-name descname"><span class="pre">SpectrumSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ellmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ellmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lensing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_pivot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switch_sw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switch_isw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switch_dop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switch_pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>CMB angular power spectrum computation.</p>
<p>Computes temperature and polarization angular power spectra by
integrating transfer functions over wavenumber and time.</p>
<section id="id180">
<h3>Methods:<a class="headerlink" href="#id180" title="Link to this heading">¶</a></h3>
<p>primordial_spectrum : Compute primordial power spectrum
Pk_lin : Compute linear matter power spectrum
get_Cl : Compute angular power spectra for multiple ℓ
Cl_one_ell : Compute angular power spectrum for single ℓ
integrand_T0 : Compute SW+ISW temperature source integrand
integrand_T1 : Compute ISW temperature source integrand
integrand_T2 : Compute polarization temperature source integrand
integrand_E : Compute E-mode polarization source integrand</p>
<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.ClEE">
<span class="sig-name descname"><span class="pre">ClEE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gg0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.ClEE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.ClEE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.ClTT_diffrax">
<span class="sig-name descname"><span class="pre">ClTT_diffrax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.ClTT_diffrax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.ClTT_diffrax" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.ClTT_loop">
<span class="sig-name descname"><span class="pre">ClTT_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.ClTT_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.ClTT_loop" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.Cl_one_ell">
<span class="sig-name descname"><span class="pre">Cl_one_ell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.Cl_one_ell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.Cl_one_ell" title="Link to this definition">¶</a></dt>
<dd><p>Compute angular power spectrum for single multipole.</p>
<p>Integrates transfer functions over wavenumber.</p>
<section id="id181">
<h4>Parameters:<a class="headerlink" href="#id181" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>idx<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>PT<span class="classifier">perturbations.PerturbationTable</span></dt><dd><p>Perturbation evolution table</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id182">
<h4>Returns:<a class="headerlink" href="#id182" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>tuple</dt><dd><p>(C_ℓ^TT, C_ℓ^TE, C_ℓ^EE) angular power spectra</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.Cl_one_ell_split">
<span class="sig-name descname"><span class="pre">Cl_one_ell_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.Cl_one_ell_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.Cl_one_ell_split" title="Link to this definition">¶</a></dt>
<dd><p>Compute angular power spectrum for single multipole.</p>
<p>Integrates transfer functions over wavenumber.</p>
<section id="id183">
<h4>Parameters:<a class="headerlink" href="#id183" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>idx<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>PT<span class="classifier">perturbations.PerturbationTable</span></dt><dd><p>Perturbation evolution table</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id184">
<h4>Returns:<a class="headerlink" href="#id184" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>tuple</dt><dd><p>(C_ℓ^TT, C_ℓ^TE, C_ℓ^EE) angular power spectra</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.Cl_one_ell_with_loops">
<span class="sig-name descname"><span class="pre">Cl_one_ell_with_loops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.Cl_one_ell_with_loops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.Cl_one_ell_with_loops" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.Pk_lin">
<span class="sig-name descname"><span class="pre">Pk_lin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.Pk_lin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.Pk_lin" title="Link to this definition">¶</a></dt>
<dd><p>Compute linear matter power spectrum at wavenumbers k and redshift z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>float</em><em> or </em><em>array</em>) – Wavenumber (Mpc^{-1})</p></li>
<li><p><strong>z</strong> (<em>float</em>) – Redshift to evaluate.</p></li>
<li><p><strong>PT</strong> (<a class="reference internal" href="#ABCMB.perturbations.PerturbationTable" title="ABCMB.perturbations.PerturbationTable"><em>perturbations.PerturbationTable</em></a>) – Perturbation evolution table</p></li>
<li><p><strong>BG</strong> (<a class="reference internal" href="#ABCMB.cosmology.Background" title="ABCMB.cosmology.Background"><em>cosmology.Background</em></a>) – Background cosmology module</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Linear matter power spectrum P(k, z), units Mpc^3</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.ells">
<span class="sig-name descname"><span class="pre">ells</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.ells" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.ells_indices">
<span class="sig-name descname"><span class="pre">ells_indices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">array</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.ells_indices" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.get_Cl">
<span class="sig-name descname"><span class="pre">get_Cl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.get_Cl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.get_Cl" title="Link to this definition">¶</a></dt>
<dd><p>Compute angular power spectra for multiple multipoles using lax.scan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.get_Cl_vmap">
<span class="sig-name descname"><span class="pre">get_Cl_vmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.get_Cl_vmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.get_Cl_vmap" title="Link to this definition">¶</a></dt>
<dd><p>Compute angular power spectra for multiple multipoles using lax.scan.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrand_E">
<span class="sig-name descname"><span class="pre">integrand_E</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrand_E"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrand_E" title="Link to this definition">¶</a></dt>
<dd><p>Compute E-mode polarization source function integrand.</p>
<section id="id185">
<h4>Parameters:<a class="headerlink" href="#id185" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ell_idx<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna_idx<span class="classifier">int</span></dt><dd><p>Index into time grid</p>
</dd>
<dt>PT<span class="classifier">perturbations.PerturbationTable</span></dt><dd><p>Perturbation evolution table</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id186">
<h4>Returns:<a class="headerlink" href="#id186" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>E-mode polarization source integrand</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrand_T0">
<span class="sig-name descname"><span class="pre">integrand_T0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrand_T0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrand_T0" title="Link to this definition">¶</a></dt>
<dd><p>Compute temperature source function integrand.</p>
<p>Calculates the integrand for SW, ISW, and Doppler contributions.</p>
<section id="id187">
<h4>Parameters:<a class="headerlink" href="#id187" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ell_idx<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna_idx<span class="classifier">int</span></dt><dd><p>Index into time grid</p>
</dd>
<dt>PT<span class="classifier">perturbations.PerturbationTable</span></dt><dd><p>Perturbation evolution table</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id188">
<h4>Returns:<a class="headerlink" href="#id188" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Temperature source integrand</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrand_T1">
<span class="sig-name descname"><span class="pre">integrand_T1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrand_T1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrand_T1" title="Link to this definition">¶</a></dt>
<dd><p>Compute ISW temperature source function integrand.</p>
<section id="id189">
<h4>Parameters:<a class="headerlink" href="#id189" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ell_idx<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna_idx<span class="classifier">int</span></dt><dd><p>Index into time grid</p>
</dd>
<dt>PT<span class="classifier">perturbations.PerturbationTable</span></dt><dd><p>Perturbation evolution table</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id190">
<h4>Returns:<a class="headerlink" href="#id190" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>ISW temperature source integrand</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrand_T2">
<span class="sig-name descname"><span class="pre">integrand_T2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrand_T2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrand_T2" title="Link to this definition">¶</a></dt>
<dd><p>Compute polarization temperature source function integrand.</p>
<section id="id191">
<h4>Parameters:<a class="headerlink" href="#id191" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>ell_idx<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>k<span class="classifier">float</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>lna_idx<span class="classifier">int</span></dt><dd><p>Index into time grid</p>
</dd>
<dt>PT<span class="classifier">perturbations.PerturbationTable</span></dt><dd><p>Perturbation evolution table</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id192">
<h4>Returns:<a class="headerlink" href="#id192" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Polarization temperature source integrand</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_scan">
<span class="sig-name descname"><span class="pre">integrate_trapezoid_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrate_trapezoid_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_scan" title="Link to this definition">¶</a></dt>
<dd><p>Trapezoid rule using lax.scan, computing integrand at each step.
No precomputation with vmap. Integrates over N_steps of PT.lna.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_trapz">
<span class="sig-name descname"><span class="pre">integrate_trapezoid_trapz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrate_trapezoid_trapz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_trapz" title="Link to this definition">¶</a></dt>
<dd><p>Integrate using jnp.trapz over N_steps of PT.lna and integrand values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_vmap_scan">
<span class="sig-name descname"><span class="pre">integrate_trapezoid_vmap_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrate_trapezoid_vmap_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_vmap_scan" title="Link to this definition">¶</a></dt>
<dd><p>Trapezoidal integrator using lax.scan over a fixed number of steps N_steps.
integrand(ell_idx, k, lna_idx, PT, BG) returns the value at each step.
PT.lna is assumed to be uniformly spaced.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_while_loop">
<span class="sig-name descname"><span class="pre">integrate_trapezoid_while_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.integrate_trapezoid_while_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.integrate_trapezoid_while_loop" title="Link to this definition">¶</a></dt>
<dd><p>A while loop trapezoid rule integrator.
Specifically used for integrating across lna for transfer function, given k.</p>
<p>integrand should take (ell_idx, k, lna_idx) and return the integrand.</p>
<p>Returns the transfer function for one ell and k value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.k_pivot">
<span class="sig-name descname"><span class="pre">k_pivot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.05</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.k_pivot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.lensed_Cls">
<span class="sig-name descname"><span class="pre">lensed_Cls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClTT_unlensed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClTE_unlensed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClEE_unlensed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.lensed_Cls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.lensed_Cls" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.lensing">
<span class="sig-name descname"><span class="pre">lensing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.lensing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.lensing_Cl">
<span class="sig-name descname"><span class="pre">lensing_Cl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.lensing_Cl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.lensing_Cl" title="Link to this definition">¶</a></dt>
<dd><p>Angular lensing power spectrum at multipole ell.</p>
<p>IMPORTANT: Assumes Limber approximation throughout, even at ell=2.</p>
<p>Eq.(3.14) in astro-ph/0601594, except shifts ell -&gt; ell+1/2 to match CLASS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ell</strong> (<em>float</em><em> or </em><em>array</em>) – Multipole</p></li>
<li><p><strong>PT</strong> (<a class="reference internal" href="#ABCMB.perturbations.PerturbationTable" title="ABCMB.perturbations.PerturbationTable"><em>perturbations.PerturbationTable</em></a>) – Perturbation evolution table</p></li>
<li><p><strong>BG</strong> (<a class="reference internal" href="#ABCMB.cosmology.Background" title="ABCMB.cosmology.Background"><em>cosmology.Background</em></a>) – Background cosmology module</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Angular lensing matter power spectrum Cl^phiphi, dimensionless.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.lensing_power_spectrum">
<span class="sig-name descname"><span class="pre">lensing_power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.lensing_power_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.lensing_power_spectrum" title="Link to this definition">¶</a></dt>
<dd><p>Computes the lensing power spectrum at wavenumbers k and redshift z.
Eq.(3.15) in astro-ph/0601594</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>float</em><em> or </em><em>array</em>) – Wavenumber (Mpc^{-1})</p></li>
<li><p><strong>lna</strong> (<em>float</em>) – Scale factor</p></li>
<li><p><strong>PT</strong> (<a class="reference internal" href="#ABCMB.perturbations.PerturbationTable" title="ABCMB.perturbations.PerturbationTable"><em>perturbations.PerturbationTable</em></a>) – Perturbation evolution table</p></li>
<li><p><strong>BG</strong> (<a class="reference internal" href="#ABCMB.cosmology.Background" title="ABCMB.cosmology.Background"><em>cosmology.Background</em></a>) – Background cosmology module</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lensing matter power spectrum P(k, z), dimensionless.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.primordial_spectrum">
<span class="sig-name descname"><span class="pre">primordial_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.primordial_spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.primordial_spectrum" title="Link to this definition">¶</a></dt>
<dd><p>Compute primordial curvature power spectrum.</p>
<section id="id193">
<h4>Parameters:<a class="headerlink" href="#id193" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>k<span class="classifier">float or array</span></dt><dd><p>Wavenumber (units: Mpc^{-1})</p>
</dd>
<dt>BG<span class="classifier">cosmology.Background</span></dt><dd><p>Background cosmology module</p>
</dd>
</dl>
</section>
<section id="id194">
<h4>Returns:<a class="headerlink" href="#id194" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>float or array</dt><dd><p>Primordial power spectrum P_R(k), units Mpc^3</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.scalar_E_source">
<span class="sig-name descname"><span class="pre">scalar_E_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fg2_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gg0_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gg2_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.scalar_E_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.scalar_E_source" title="Link to this definition">¶</a></dt>
<dd><p>Computes the scalar source function for E-mode polarization.
See Eq.(3.2) of <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf">https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf</a></p>
<dl class="simple">
<dt>Params:</dt><dd><p>k : float
ell : float
lna_axis : jnp.array
Fg2 : jnp.array (same shape as lna_axis)
Gg0 : jnp.array (same shape as lna_axis)
Gg2 : jnp.array (same shape as lna_axis)
BG  : cosmology.Background</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.scalar_T0_transfer">
<span class="sig-name descname"><span class="pre">scalar_T0_transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.scalar_T0_transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.scalar_T0_transfer" title="Link to this definition">¶</a></dt>
<dd><p>Computes the scalar transfer function T0 for the temperature anisotropy.
See Eqs.(3.1) &amp; (3.5) of <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf">https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf</a></p>
<dl class="simple">
<dt>Params:</dt><dd><p>k : float
ell : float
PT : perturbations.PerturbationTable
BG  : cosmology.Background
firstx : float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.scalar_T1_transfer">
<span class="sig-name descname"><span class="pre">scalar_T1_transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.scalar_T1_transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.scalar_T1_transfer" title="Link to this definition">¶</a></dt>
<dd><p>Computes the scalar transfer function T1 for the temperature anisotropy.
See Eqs.(3.1) &amp; (3.5) of <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf">https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf</a></p>
<dl class="simple">
<dt>Params:</dt><dd><p>k : float
ell : float
PT : perturbations.PerturbationTable
BG  : cosmology.Background</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.scalar_T2_transfer">
<span class="sig-name descname"><span class="pre">scalar_T2_transfer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.scalar_T2_transfer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.scalar_T2_transfer" title="Link to this definition">¶</a></dt>
<dd><p>Computes the scalar transfer function T2 for the temperature anisotropy.
See Eqs.(3.1) &amp; (3.5) of <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf">https://iopscience.iop.org/article/10.1088/1475-7516/2014/09/032/pdf</a></p>
<dl class="simple">
<dt>Params:</dt><dd><p>k : float
ell : float
PT : perturbations.PerturbationTable
BG  : cosmology.Background</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.stop_T0">
<span class="sig-name descname"><span class="pre">stop_T0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.stop_T0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.stop_T0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.stop_T1T2E">
<span class="sig-name descname"><span class="pre">stop_T1T2E</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lna_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#SpectrumSolver.stop_T1T2E"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.stop_T1T2E" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.switch_dop">
<span class="sig-name descname"><span class="pre">switch_dop</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.switch_dop" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.switch_isw">
<span class="sig-name descname"><span class="pre">switch_isw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.switch_isw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.switch_pol">
<span class="sig-name descname"><span class="pre">switch_pol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.switch_pol" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ABCMB.spectrum.SpectrumSolver.switch_sw">
<span class="sig-name descname"><span class="pre">switch_sw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#ABCMB.spectrum.SpectrumSolver.switch_sw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.spectrum.epsilon">
<span class="sig-prename descclassname"><span class="pre">ABCMB.spectrum.</span></span><span class="sig-name descname"><span class="pre">epsilon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#epsilon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.epsilon" title="Link to this definition">¶</a></dt>
<dd><p>Compute polarization coupling function ε.</p>
<section id="id195">
<h3>Parameters:<a class="headerlink" href="#id195" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>i<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>x<span class="classifier">float</span></dt><dd><p>Argument of coupling function</p>
</dd>
</dl>
</section>
<section id="id196">
<h3>Returns:<a class="headerlink" href="#id196" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>ε(x) for multipole ℓ = bessel_l_tab[i]</p>
</dd>
</dl>
</section>
<section id="id197">
<h3>Notes:<a class="headerlink" href="#id197" title="Link to this heading">¶</a></h3>
<p>1312.2697 Eq. (3.19b)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.spectrum.phi0">
<span class="sig-prename descclassname"><span class="pre">ABCMB.spectrum.</span></span><span class="sig-name descname"><span class="pre">phi0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#phi0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.phi0" title="Link to this definition">¶</a></dt>
<dd><p>Compute spherical Bessel function φ₀.</p>
<p>First integer argument i indicates we are computing this for l = bessel_l_tab[i]
float argument x is the argument of the bessel function.</p>
<section id="id198">
<h3>Parameters:<a class="headerlink" href="#id198" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>i<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>x<span class="classifier">float</span></dt><dd><p>Argument of spherical Bessel function</p>
</dd>
</dl>
</section>
<section id="id199">
<h3>Returns:<a class="headerlink" href="#id199" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>φ₀(x) for multipole ℓ = bessel_l_tab[i]</p>
</dd>
</dl>
</section>
<section id="id200">
<h3>Notes:<a class="headerlink" href="#id200" title="Link to this heading">¶</a></h3>
<p>1312.2697 Eq. (3.19a)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.spectrum.phi1">
<span class="sig-prename descclassname"><span class="pre">ABCMB.spectrum.</span></span><span class="sig-name descname"><span class="pre">phi1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#phi1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.phi1" title="Link to this definition">¶</a></dt>
<dd><p>Compute spherical Bessel function φ₁.</p>
<section id="id201">
<h3>Parameters:<a class="headerlink" href="#id201" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>i<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>x<span class="classifier">float</span></dt><dd><p>Argument of spherical Bessel function</p>
</dd>
</dl>
</section>
<section id="id202">
<h3>Returns:<a class="headerlink" href="#id202" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>φ₁(x) for multipole ℓ = bessel_l_tab[i]</p>
</dd>
</dl>
</section>
<section id="id203">
<h3>Notes:<a class="headerlink" href="#id203" title="Link to this heading">¶</a></h3>
<p>1312.2697 Eq. (3.19a)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ABCMB.spectrum.phi2">
<span class="sig-prename descclassname"><span class="pre">ABCMB.spectrum.</span></span><span class="sig-name descname"><span class="pre">phi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ABCMB/spectrum.html#phi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ABCMB.spectrum.phi2" title="Link to this definition">¶</a></dt>
<dd><p>Compute spherical Bessel function φ₂.</p>
<section id="id204">
<h3>Parameters:<a class="headerlink" href="#id204" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>i<span class="classifier">int</span></dt><dd><p>Index into bessel_l_tab for multipole ℓ</p>
</dd>
<dt>x<span class="classifier">float</span></dt><dd><p>Argument of spherical Bessel function</p>
</dd>
</dl>
</section>
<section id="id205">
<h3>Returns:<a class="headerlink" href="#id205" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>float</dt><dd><p>φ₂(x) for multipole ℓ = bessel_l_tab[i]</p>
</dd>
</dl>
</section>
<section id="id206">
<h3>Notes:<a class="headerlink" href="#id206" title="Link to this heading">¶</a></h3>
<p>1312.2697 Eq. (3.19a)</p>
</section>
</dd></dl>

</section>
<section id="abcmb-testgpu-module">
<h2>ABCMB.testGPU module<a class="headerlink" href="#abcmb-testgpu-module" title="Link to this heading">¶</a></h2>
</section>
<section id="module-ABCMB">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ABCMB" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ABCMB</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">ABCMB</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ABCMB package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">ABCMB</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">ABCMB</a></li>
      <li>Next: <a href="ABCMB.hyrax.html" title="next chapter">ABCMB.hyrax package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Zilu Zhou, Cara Giovanetti, and Hongwan Liu.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/ABCMB.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>