<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ABCMB.hyrax.cosmology &#8212; ABCMB 0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=837179f8"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for ABCMB.hyrax.cosmology</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">jax</span><span class="w"> </span><span class="kn">import</span> <span class="n">config</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">c</span>           <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">29979245800.</span><span class="p">)</span>           <span class="c1"># Speed of light in cm s^{-1}</span>
<span class="n">hbar</span>        <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">6.582119569509e-16</span><span class="p">)</span>     <span class="c1"># hbar in eV s</span>
<span class="n">G</span>           <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1.18980205e-40</span><span class="p">)</span>         <span class="c1"># Newton&#39;s gravitational constant (G/c^2), in cm^3 eV^{-1} s^{-2}</span>
<span class="n">kB</span>          <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">8.617343e-5</span><span class="p">)</span>            <span class="c1"># Boltzmann constant in eV / K</span>
<span class="n">mp</span>          <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.938271999e+09</span><span class="p">)</span>        <span class="c1"># Proton rest mass, in eV</span>
<span class="n">me</span>          <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">510998.9461</span><span class="p">)</span>            <span class="c1"># Electron rest mass, in eV</span>
<span class="n">TCMB_today</span>  <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">2.34865418e-4</span><span class="p">)</span>          <span class="c1"># CMB temperature today in eV.</span>
<span class="n">conv_factor</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">3.2407792894443648e-18</span><span class="p">)</span> <span class="c1"># (100 km/s/Mpc) in units of s^{-1}</span>
<span class="n">mH</span>          <span class="o">=</span> <span class="n">mp</span><span class="o">+</span><span class="n">me</span><span class="o">+</span><span class="mf">13.598286071938324</span>            <span class="c1"># Neutral hydrogen atom rest mass, in eV</span>
<span class="n">mu_e</span>        <span class="o">=</span> <span class="n">mp</span><span class="o">*</span><span class="n">me</span><span class="o">/</span><span class="n">mH</span>                            <span class="c1"># Reduced mass of proton-electron system, in eV</span>

<div class="viewcode-block" id="a">
<a class="viewcode-back" href="../../../ABCMB.hyrax.html#ABCMB.hyrax.cosmology.a">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts redshift to scale factor.</span>

<span class="sd">    Dimensions: None</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z : float/jnp.array</span>
<span class="sd">        Requested redshift(s)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a : float/jnp.array</span>
<span class="sd">        Scale factor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">z</span><span class="p">)</span></div>


<div class="viewcode-block" id="omega_rad0">
<a class="viewcode-back" href="../../../ABCMB.hyrax.html#ABCMB.hyrax.cosmology.omega_rad0">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">omega_rad0</span><span class="p">(</span><span class="n">Neff</span><span class="o">=</span><span class="mf">3.044</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates radiation density today.</span>

<span class="sd">    Dimensions: None</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Neff : float</span>
<span class="sd">        Cosmological parameter, effective number of neutrino species</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    omega_rad0 : float</span>
<span class="sd">        The radiation density today.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># CMB photon energy density, in eV cm^{-3}</span>
    <span class="n">rho_g0</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">15.</span><span class="o">/</span><span class="n">hbar</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">c</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">TCMB_today</span><span class="o">**</span><span class="mi">4</span>
    
    <span class="c1"># Neutrino energy density today</span>
    <span class="n">rho_nu0</span> <span class="o">=</span> <span class="n">Neff</span><span class="o">*</span><span class="p">(</span><span class="mf">7.</span><span class="o">/</span><span class="mf">8.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.</span><span class="o">/</span><span class="mf">11.</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">4.</span><span class="o">/</span><span class="mf">3.</span><span class="p">))</span> <span class="o">*</span> <span class="n">rho_g0</span>

    <span class="c1"># Total radiation density</span>
    <span class="n">rho_r0</span> <span class="o">=</span> <span class="n">rho_g0</span> <span class="o">+</span> <span class="n">rho_nu0</span>

    <span class="c1"># Divide by rho critical today to yield the dimensionless density param</span>
    <span class="n">omega_rad0</span> <span class="o">=</span> <span class="mf">8.</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">G</span><span class="o">/</span><span class="mf">3.</span><span class="o">/</span><span class="n">conv_factor</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rho_r0</span>

    <span class="k">return</span> <span class="n">omega_rad0</span></div>


<div class="viewcode-block" id="Hubble">
<a class="viewcode-back" href="../../../ABCMB.hyrax.html#ABCMB.hyrax.cosmology.Hubble">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Hubble</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">omega_b</span><span class="p">,</span> <span class="n">omega_cdm</span><span class="p">,</span> <span class="n">omega_rad</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the Hubble constant at given redshift and values of relevant cosmology parameters.</span>

<span class="sd">    Dimensions: s^{-1}</span>

<span class="sd">    WARNING: Assumes flatness (i.e. Om_m + Om_r + Om_Lambda = 1)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z : float/jnp.array</span>
<span class="sd">        Requested redshift(s)</span>
<span class="sd">    h : float</span>
<span class="sd">        Cosmological parameter, reduced Hubble parameter today defined as H0 / (100 km/s/Mpc)</span>
<span class="sd">    omega_b : float</span>
<span class="sd">        Cosmological parameter, baryon density fraction today.</span>
<span class="sd">    omega_cdm : float</span>
<span class="sd">        Cosmological parameter, cold dark matter density fraction today.</span>
<span class="sd">    omega_rad : float</span>
<span class="sd">        Cosmological parameter, radiation density fraction today.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H : float/jnp.array</span>
<span class="sd">        Hubble parameter at requested redshifts, in s^{-1}.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Total matter density (same redshift for both)</span>
    <span class="n">omega_m</span> <span class="o">=</span> <span class="n">omega_b</span> <span class="o">+</span> <span class="n">omega_cdm</span>

    <span class="c1"># Dark energy density</span>
    <span class="n">omega_Lambda</span> <span class="o">=</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">omega_m</span> <span class="o">-</span> <span class="n">omega_rad</span>
    
    <span class="c1"># Friedmann&#39;s equation</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">conv_factor</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">omega_rad</span><span class="o">/</span><span class="n">a</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">omega_m</span><span class="o">/</span><span class="n">a</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">omega_Lambda</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">H</span></div>


<div class="viewcode-block" id="nH">
<a class="viewcode-back" href="../../../ABCMB.hyrax.html#ABCMB.hyrax.cosmology.nH">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">nH</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">omega_b</span><span class="p">,</span> <span class="n">YHe</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the total hydrogen number density at redshift z.</span>
<span class="sd">    </span>
<span class="sd">    Dimensions: cm^{-3}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z : float/jnp.array</span>
<span class="sd">        Requested redshift(s).</span>
<span class="sd">    omega_b : float</span>
<span class="sd">        Cosmological parameter, baryon density fraction today.</span>
<span class="sd">    YHe : float</span>
<span class="sd">        Helium mass fraction.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nH : float</span>
<span class="sd">        Hydrogen number density at redshift z.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">YHe</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">omega_b</span> <span class="o">*</span> <span class="n">conv_factor</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">G</span> <span class="o">/</span> <span class="n">mH</span> <span class="o">/</span> <span class="n">a</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span></div>


<div class="viewcode-block" id="TCMB">
<a class="viewcode-back" href="../../../ABCMB.hyrax.html#ABCMB.hyrax.cosmology.TCMB">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">TCMB</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the CMB temperature at redshift z.</span>

<span class="sd">    Dimensions: eV</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z : float/jnp.array</span>
<span class="sd">        Requested redshift(s).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    TCMB : float/jnp.array</span>
<span class="sd">        CMB temperature.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">TCMB_today</span> <span class="o">/</span> <span class="n">a</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></div>



</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ABCMB</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">ABCMB</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Zilu Zhou, Cara Giovanetti, and Hongwan Liu.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>